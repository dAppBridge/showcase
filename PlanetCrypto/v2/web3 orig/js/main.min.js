"use strict";function _asyncToGenerator(t){return function(){var o=t.apply(this,arguments);return new Promise(function(r,l){function d(p,u){try{var g=o[p](u),m=g.value}catch(h){return void l(h)}return g.done?void r(m):Promise.resolve(m).then(function(h){d("next",h)},function(h){d("throw",h)})}return d("next")})}}var OLD_TOKEN_LIMIT=150,canPlay=!1,minBet=1e-3,maxBet=2e-3,account=0,PlanetCryptoContract,PlanetCryptoContractOld,PlanetCryptoContractOld2,PlanetCryptoContractPlay,PlanetCryptoCoinContract,PlanetCryptoCoinContractPlay,playing=!1,useGasPrice=1e10,ethGasStationAPI="https://ethgasstation.info/json/ethgasAPI.json",contractAddress="0x533bafa16aa76218ec4a365ad71bf8816cf21bbb",coinsContractAddress="0xA1c8031EF18272d8BfeD22E1b61319D6d9d2881B",contractAddressOld="0x8C55B18e6bb7083b29102e57c34d0C3124c0a952",contractAddressOld2="0x1806B3527C18Fb532C46405f6f014C1F381b499A",logsSubscription,useTestnet=!1,isMainGame=!0,isDetail=!1,eth_to_usd=194.683,PLOT_SIZE=20,CURRENT_RESALE_MULTIPLIER=2,CURRENT_EMPIRE_MULTIPLIER=1.5,PERCENT_SPEED=200,GAME_UPDATE_SPEED=1e4,MIN_BUY_LVL=17,MAX_BUY_RADIUS=200,currentLandPrice=new BigNumber(2e16),currentEmpirePerPlot=100,displayGameID=1,maxGames=2,_referer="0x0000000000000000000000000000000000000000",rects={},grid18,grid17,grid16,grid15,lightGrids={},grid14,grid13,grid12,grid11,grid10,grid9,grid8,grid7,grid6,grid5,grid4,grid3,grid2,grid1,grid0,gridIinit=!1,grid17Iinit=!1,grid16Iinit=!1,grid15Iinit=!1,grid14Iinit=!1,grid13Iinit=!1,grid12Iinit=!1,grid11Iinit=!1,grid10Iinit=!1,grid9Iinit=!1,grid8Iinit=!1,grid7Iinit=!1,grid6Iinit=!1,grid5Iinit=!1,grid4Iinit=!1,grid3Iinit=!1,grid2Iinit=!1,grid1Iinit=!1,grid0Iinit=!1,onDownEvent=!1,inSubtractionMode=!1,rectsToBuy={},mymap,_findTokenId,layer,layerLabels,actionMode="",allowedPlotsCircle,currentlySelectedMarker,currentlySelectedMarkerRemoved=!1,blankCardIcon=L.icon({iconUrl:"images/blank-card.png",iconSize:[37,50],iconAnchor:[37,50],shadowUrl:"images/card-shadow.png",shadowSize:[38,52],shadowAnchor:[34,47]}),isConnected=!1,minPlayAmount=new BigNumber(0),userWalletAddress="0x00",userWalletAddressShort="0x00",userWalletBalance=0,TOAST_HIDE_DELAY=1e4,TOAST_HIDE_TRANSITION="slide",web3Connection,gameConnection,gameConnectionConnected=!1,statsConnectionConnected=!1,currentPlayers=0,currentUserLand=0,currentUserEmpireScore=0,tokens={},plots={},isCard=0,CONNECTION_TO_USE="wss://mainnet.infura.io/ws";function viewContract(){var t=window.open("https://etherscan.io/address/"+contractAddress,"_blank");t&&t.focus()}var share_url="https://planetcrypto.app",share_title="Planet Crypto ~ Own the World!",share_description="Im playing the biggest Crypto Game - Plant Crypto...";function shareExistingCard(){window.open("https://www.addthis.com/bookmark.php?url="+escape(share_url)+"&pub_id=ra-5bed6d6fe2749d93&description="+escape(share_description),"_blank")}var isMobile=!1,shareEarnEthBtn,provider;window.addEventListener("load",function(){if(-1<window.location.href.indexOf("card.htm")&&(isCard="1"),"1"==isCard)setupReadOnlyWeb3();else{if(window.ethereum){gameConnection=new Web3(ethereum);try{var u=function(){var g=_asyncToGenerator(regeneratorRuntime.mark(function m(){var h;return regeneratorRuntime.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.prev=0,f.next=3,ethereum.enable();case 3:h=f.sent,gameConnectionConnected=!0;try{PlanetCryptoContractPlay=new gameConnection.eth.Contract(planetCryptoABI,contractAddress),PlanetCryptoContractOld=new gameConnection.eth.Contract(planetCryptoABI,contractAddressOld),PlanetCryptoContractOld2=new gameConnection.eth.Contract(planetCryptoABI,contractAddressOld2)}catch(C){}try{PlanetCryptoCoinContractPlay=new gameConnection.eth.Contract(planetCryptoCoinABI,coinsContractAddress)}catch(C){}checkNetwork(),f.next=15;break;case 10:f.prev=10,f.t0=f["catch"](0),console.log("Error getting permission",f.t0),gameConnectionConnected=!1,startApp();case 15:setupReadOnlyWeb3();case 16:case"end":return f.stop();}},m,this,[[0,10]])}));return function(){return g.apply(this,arguments)}}();u()}catch(g){setupReadOnlyWeb3(),showError("To play PlanetCrypto.app you need to enable permission for our domain (planetcrypto.app) for your Ethereum Wallet","Planet Crypto")}}else if(window.web3){gameConnection=new Web3(web3.currentProvider),gameConnectionConnected=!0;try{PlanetCryptoContractPlay=new gameConnection.eth.Contract(planetCryptoABI,contractAddress),PlanetCryptoContractOld=new gameConnection.eth.Contract(planetCryptoABI,contractAddressOld),PlanetCryptoContractOld2=new gameConnection.eth.Contract(planetCryptoABI,contractAddressOld2)}catch(g){}try{PlanetCryptoCoinContractPlay=new gameConnection.eth.Contract(planetCryptoCoinABI,coinsContractAddress)}catch(g){}checkNetwork(),setupReadOnlyWeb3()}else console.log("Non-Ethereum browser detected. You should consider trying MetaMask!"),setupReadOnlyWeb3();setNewCardBg()}if($(document).foundation(),_findTokenId=getUrlParameter("token_id")||"","1"==isCard)setupImgMap();else{var o=window.matchMedia("only screen and (max-width: 760px)");o.matches&&(isMobile=!0),setupMap();var r=getUrlParameter("ref")||"";if(0<r.length)_referer=r;else{var l=""|Cookies.get("ref");0<l.length&&(_referer=l)}Cookies.set("ref",_referer,{expires:30}),googleTranslateElementInit(),$.getJSON(ethGasStationAPI,function(g){if(isNaN(g.average))console.log("Unable to access ethgasstation");else{var m=new BigNumber(g.average).times(1e8);console.log("New Gas:",m.toString()),useGasPrice=parseInt(m.toString())}console.log("Average",g.average)}),shareEarnEthBtn?shareEarnEthBtn.options.url="https://planetcrypto.app/?ref="+userWalletAddress:shareEarnEthBtn=new needShareDropdown(document.getElementById("shareEarnEth"),{url:"https://planetcrypto.app/?ref="+userWalletAddress}),$("#jumpToLocation").change(function(){$("#welcomeDiv").foundation("close"),processJumpToLocationEvent(this)}),$("#jumpToLocation2").change(function(){$("#guideDiv").foundation("close"),processJumpToLocationEvent(this)}),$("#buyUpsellButtonConfirm").click(function(){buyWithEth()}),$("#buywthETH").click(function(){buyWithEthUpsell()}),$("#buywthTokens").click(function(){buyWithTokens()}),$("#withdrawButton").click(function(){withdrawFunds()}),$("#withdrawButton2").click(function(){withdrawFunds()}),$("#existingCardURLLink").click(function(){window.open("https://"+document.getElementById("existingCardsURL").innerHTML,"_blank")}),$("#ownedCardsBtn").click(function(){$("#userLostCards2").removeClass("hide").addClass("hide"),$("#userCards2").removeClass("hide")}),$("#previousCardsBtn").click(function(){$("#userCards2").removeClass("hide").addClass("hide"),$("#userLostCards2").removeClass("hide")}),$("#cancelBuy").click(function(){$("#clearBuyConfirm").foundation("open")}),$("#getStartedButton").click(function(){$("#welcomeDiv").foundation("close")}),$("#welcomeIntroImage").click(function(){$("#welcomeDiv").foundation("close")}),$("#welcomeIntroImage2").click(function(){$("#guideDiv").foundation("close"),ga("send","event","GeneralActions","StartGameClicked")}),$("#welcomeDiv").on("closed.zf.reveal",function(){console.log("WELCOME CLOSED"),ga("send","event","GeneralActions","StartGameClicked"),$("#google_translate_element").removeClass("google_translate_element").addClass("google_translate_element_final")}),$("#readMoreButton").click(function(){showGuide()}),$("#cryptoGuideBtn").click(function(){showGuide()}),$("#cryptoGuideBtnMobile").click(function(){showGuide()}),$("#buyMultiple").click(function(){startBuyMultiple()}),$("#buySingle").click(function(){startBuySingle()}),$("#removeSingle").click(function(){startRemoveSingle()}),$("#removeAll").click(function(){$("#clearBuyConfirm").foundation("open")}),$("#buySingleMobile").click(function(){startBuySingle()}),$("#removeSingleMobile").click(function(){startRemoveSingle()}),$("#removeAllMobile").click(function(){$("#clearBuyConfirm").foundation("open")}),$("#padlockLink").click(function(){switchCOINlockstatus()}),$("#padlockLinkMobile").click(function(){switchCOINlockstatus()}),$("#clearBuyButtonConfirm").click(function(){startRemoveAll()}),$("#newCardStartPointLink").click(function(){gotoStartPointLink()}),$("#existingCardStartPointLink").click(function(){gotoExistingCardStartPoint()}),$("#existingCardOwner").click(function(){window.open("https://etherscan.io/address/"+document.getElementById("existingCardOwner").value,"_blank")}),$("#buyExistingWthETH").click(function(){buyExistingCard()}),$("#destoryButtonBuy").click(function(){buyExistingCard()}),$("#destoryButtonConfirm").click(function(){destroyCard()}),$("#newCardStartOwner").click(function(){window.open("https://etherscan.io/address/"+document.getElementById("newCardOwnerAddr").value,"_blank")}),$("#closeExistingCard").click(function(){$("#existingCardDiv").foundation("close")}),$("#destoryExistingCard").click(function(){destroyConfirm()});new Foundation.Tabs($("#bottomCardsTabs"));$("#bottomCardsTabs").on("change.zf.tabs",function(){$("#panel1:visible").length&&($("#tab1").addClass("tabs-title1-selected").removeClass("tabs-title1"),$("#tab2").addClass("tabs-title-standard").removeClass("tabs-title-standard-selected"),$("#tab3").addClass("tabs-title-standard").removeClass("tabs-title-standard-selected"),$("#tab4").addClass("tabs-title-standard").removeClass("tabs-title-standard-selected"),$("#tab5").addClass("tabs-title-standard").removeClass("tabs-title-standard-selected"),$("#tab6").addClass("tabs-title-standard").removeClass("tabs-title-standard-selected")),$("#panel2:visible").length&&($("#tab1").addClass("tabs-title1").removeClass("tabs-title1-selected"),$("#tab2").addClass("tabs-title-standard-selected").removeClass("tabs-title-standard"),$("#tab3").addClass("tabs-title-standard").removeClass("tabs-title-standard-selected"),$("#tab4").addClass("tabs-title-standard").removeClass("tabs-title-standard-selected"),$("#tab5").addClass("tabs-title-standard").removeClass("tabs-title-standard-selected"),$("#tab6").addClass("tabs-title-standard").removeClass("tabs-title-standard-selected")),$("#panel3:visible").length&&($("#tab1").addClass("tabs-title1").removeClass("tabs-title1-selected"),$("#tab2").addClass("tabs-title-standard").removeClass("tabs-title-standard-selected"),$("#tab3").addClass("tabs-title-standard-selected").removeClass("tabs-title-standard"),$("#tab4").addClass("tabs-title-standard").removeClass("tabs-title-standard-selected"),$("#tab5").addClass("tabs-title-standard").removeClass("tabs-title-standard-selected"),$("#tab6").addClass("tabs-title-standard").removeClass("tabs-title-standard-selected")),$("#panel4:visible").length&&($("#tab1").addClass("tabs-title1").removeClass("tabs-title1-selected"),$("#tab2").addClass("tabs-title-standard").removeClass("tabs-title-standard-selected"),$("#tab3").addClass("tabs-title-standard").removeClass("tabs-title-standard-selected"),$("#tab4").addClass("tabs-title-standard-selected").removeClass("tabs-title-standard"),$("#tab5").addClass("tabs-title-standard").removeClass("tabs-title-standard-selected"),$("#tab6").addClass("tabs-title-standard").removeClass("tabs-title-standard-selected")),$("#panel5:visible").length&&($("#tab1").addClass("tabs-title1").removeClass("tabs-title1-selected"),$("#tab2").addClass("tabs-title-standard").removeClass("tabs-title-standard-selected"),$("#tab3").addClass("tabs-title-standard").removeClass("tabs-title-standard-selected"),$("#tab4").addClass("tabs-title-standard").removeClass("tabs-title-standard-selected"),$("#tab5").addClass("tabs-title-standard-selected").removeClass("tabs-title-standard"),$("#tab6").addClass("tabs-title-standard").removeClass("tabs-title-standard-selected")),$("#panel6:visible").length&&($("#tab1").addClass("tabs-title1").removeClass("tabs-title1-selected"),$("#tab2").addClass("tabs-title-standard").removeClass("tabs-title-standard-selected"),$("#tab3").addClass("tabs-title-standard").removeClass("tabs-title-standard-selected"),$("#tab4").addClass("tabs-title-standard").removeClass("tabs-title-standard-selected"),$("#tab5").addClass("tabs-title-standard").removeClass("tabs-title-standard-selected"),$("#tab6").addClass("tabs-title-standard-selected").removeClass("tabs-title-standard")),$("#panel7:visible").length&&($("#tab1").addClass("tabs-title1").removeClass("tabs-title1-selected"),$("#tab2").addClass("tabs-title-standard").removeClass("tabs-title-standard-selected"),$("#tab3").addClass("tabs-title-standard").removeClass("tabs-title-standard-selected"),$("#tab4").addClass("tabs-title-standard").removeClass("tabs-title-standard-selected"),$("#tab5").addClass("tabs-title-standard").removeClass("tabs-title-standard-selected"),$("#tab6").addClass("tabs-title-standard").removeClass("tabs-title-standard-selected"),$("#tab7").addClass("tabs-title-standard-selected").removeClass("tabs-title-standard"))}),$("#loadingGif").attr("src","images/loading.gif"),$("#loadingGif2").attr("src","images/loading.gif"),$("#welcomeCard1").attr("src","images/real_madrid_card.jpg"),$("#welcomeCard2").attr("src","images/the_alamo_card.jpg");var p=getUrlParameter("hideWelcome")||"";"1"==p||($("#welcomeDiv").removeClass("hide"),$("#welcomeDiv").foundation("open"))}});function setupReadOnlyWeb3(){console.log("gameConnectionConnected",gameConnectionConnected),gameConnectionConnected||(provider=new Web3.providers.WebsocketProvider(CONNECTION_TO_USE),console.log("provider:",provider),console.log("GAME CONNECTION:",gameConnection),provider.on("connect",function(){web3Connection=new Web3(provider),console.log("Starting main listeners"),setTimeout(function(){statsConnectionConnected=!0,startApp()},500)}),provider.on("error",function(t){console.error("WS Error",t),reconnectProvider(0)}),provider.on("end",function(){reconnectProvider(0)}))}var fireGameDataReadyCounter=0,finalLogItemProcessed=!1;function processLogResult(t,o,r,l){var d=!0;if(!0==o&&(d=!1),"landPurchased"==t.event){if(!0==o)!0==r?(populateTokens(t.returnValues.token_id,!0,l),finalLogItemProcessed=!0):0==fireGameDataReadyCounter?(populateTokens(t.returnValues.token_id,!0,l),fireGameDataReadyCounter=10):(populateTokens(t.returnValues.token_id,!1,l),fireGameDataReadyCounter--),parseInt(t.returnValues.token_id)>totalCards&&(totalCards=parseInt(t.returnValues.token_id)),updateInnerHTML("totalCards",totalCards),updateInnerHTML("totalCardsMobile",totalCards),200<totalCards&&updateInnerHTML("startCards",totalCards);else{setTimeout(function(){populateTokens(t.returnValues.token_id,!0,l)},2500);var p="By: "+t.returnValues.buyer.substring(0,10)+"...<br/>";if(p+="For: "+getReadOnlyWeb3Utils().utils.fromWei(t.returnValues.bought_at.toString(),"ether").substring(0,8)+" ETH<br/>",p+="Size: "+parseInt(t.returnValues.size)*PLOT_SIZE+"m<sup>2</sup><br/>",p+="Empire Score: +"+t.returnValues.empire_score,$.toast({heading:"New Card Purchased!",text:p,icon:"info",allowToastClose:!0,position:"bottom-right",hideAfter:TOAST_HIDE_DELAY,showHideTransition:TOAST_HIDE_TRANSITION}),totalLandSize+=parseInt(t.returnValues.size)*PLOT_SIZE,updateTotalLandSize(),totalCards++,updateInnerHTML("totalCards",totalCards),updateInnerHTML("totalCardsMobile",totalCards),200<totalCards&&updateInnerHTML("startCards",totalCards),t.returnValues.buyer.toUpperCase()==userWalletAddress.toUpperCase()){currentUserLand+=parseInt(t.returnValues.size)*PLOT_SIZE;var u=currentUserLand,g="m";99999<u&&(u/=1e3,g="km"),updateInnerHTML("yourLandSize",u+g),updateInnerHTML("yourLandSizeMobile",u+g),currentUserEmpireScore+=parseInt(t.returnValues.empire_score),updateInnerHTML("yourEmpireScore",currentUserEmpireScore),updateInnerHTML("yourEmpireScoreMobile",currentUserEmpireScore)}}l&&l()}if(d){if("taxDistributed"==t.event&&0<parseInt(t.returnValues.amnt)){var p="Amount: "+getReadOnlyWeb3Utils().utils.fromWei(t.returnValues.amnt.toString(),"ether").substring(0,8)+" ETH<br/>";p+="To: "+t.returnValues.total_players+" Players",$.toast({heading:"Land Tax Distributed!",text:p,icon:"info",allowToastClose:!0,position:"bottom-right",hideAfter:TOAST_HIDE_DELAY,showHideTransition:TOAST_HIDE_TRANSITION})}if("referralPaid"==t.event){var p=t.returnValues.to.substring(0,10)+"...<br/>";p+="has just earned a referral bonus of:<br/>",p+=getReadOnlyWeb3Utils().utils.fromWei(t.returnValues.amnt.toString(),"ether").substring(0,8)+" ETH<br/>",p+="Check the Guide for info on how you can earn ETH!",$.toast({heading:"Referral Bonus Earned!",text:p,icon:"info",allowToastClose:!0,position:"bottom-right",hideAfter:TOAST_HIDE_DELAY,showHideTransition:TOAST_HIDE_TRANSITION})}if("issueCoinTokens"==t.event){var p=t.returnValues.to.substring(0,10)+"...<br/>";p+="has just earned a PlanetCOINs:<br/>",p+=t.returnValues.amnt.toString()+" PlanetCOINS<br/>",p+="Check the Guide for info on how you can earn PlanetCOINS!",$.toast({heading:"PlanetCOINs Earned!",text:p,icon:"info",allowToastClose:!0,position:"bottom-right",hideAfter:TOAST_HIDE_DELAY,showHideTransition:TOAST_HIDE_TRANSITION})}}if("cardBought"==t.event){if(tokens[t.returnValues.token_id].buy_history.push({token_owner:t.returnValues.to,from:t.returnValues.from,bought_at:t.returnValues.new_value,orig_value:t.returnValues.orig_value,ts:t.returnValues.now}),o);else{var m;try{m=getReadOnlyWeb3Utils().utils.utf8ToHex(t.returnValues.name)}catch(h){m=getReadOnlyWeb3Utils().utils.fromAscii(t.returnValues.name)}var p="Name: "+m+"<br/>";p+="By: "+t.returnValues.to.substring(0,10)+"...<br/>",p+="From: "+t.returnValues.from.substring(0,10)+"...<br/>",p+="For: "+getReadOnlyWeb3Utils().utils.fromWei(t.returnValues.new_value.toString(),"ether").substring(0,8)+" ETH<br/>",p+="Empire Score: +"+t.returnValues.newEmpireScore,t.returnValues.from.toUpperCase()==userWalletAddress.toUpperCase()?$.toast({heading:"One of your cards has been taken over!",text:p,icon:"error",allowToastClose:!0,position:"bottom-right",hideAfter:TOAST_HIDE_DELAY,showHideTransition:TOAST_HIDE_TRANSITION}):$.toast({heading:"Card Hostile Take Over!",text:p,icon:"info",allowToastClose:!0,position:"bottom-right",hideAfter:TOAST_HIDE_DELAY,showHideTransition:TOAST_HIDE_TRANSITION}),totalTrades++,updateInnerHTML("totalTrades",totalTrades),updateInnerHTML("totalTradesMobile",totalTrades),t.returnValues.to.toUpperCase()==userWalletAddress.toUpperCase()&&getReadOnlyPlanetCryptoContract().methods.getToken(t.returnValues.token_id,!1).call(function(h,y){if(!h){currentUserLand+=parseInt(y.plots_lat.length)*PLOT_SIZE;var f=currentUserLand,C="m";99999<f&&(f/=1e3,C="km"),updateInnerHTML("yourLandSize",f+C),updateInnerHTML("yourLandSizeMobile",f+C),currentUserEmpireScore+=parseInt(t.returnValues.newEmpireScore),updateInnerHTML("yourEmpireScore",currentUserEmpireScore),updateInnerHTML("yourEmpireScoreMobile",currentUserEmpireScore)}}),t.returnValues.from.toUpperCase()==userWalletAddress.toUpperCase()&&($("#userCardFull"+t.returnValues.token_id).remove(),getReadOnlyPlanetCryptoContract().methods.getToken(t.returnValues.token_id,!1).call(function(h,y){if(!h){currentUserLand-=parseInt(y.plots_lat.length)*PLOT_SIZE;var f=currentUserLand,C="m";99999<f&&(f/=1e3,C="km"),updateInnerHTML("yourLandSize",f+C),updateInnerHTML("yourLandSizeMobile",f+C),currentUserEmpireScore-=parseInt(t.returnValues.empireScore),updateInnerHTML("yourEmpireScore",currentUserEmpireScore),updateInnerHTML("yourEmpireScoreMobile",currentUserEmpireScore)}}))}l&&l()}"Transfer"==t.event&&(tokens[t.returnValues.tokenId]&&(tokens[t.returnValues.tokenId].buy_history.push({token_owner:t.returnValues.to,from:t.returnValues.from}),o||(totalTrades++,updateInnerHTML("totalTrades",totalTrades),updateInnerHTML("totalTradesMobile",totalTrades),t.returnValues.to.toUpperCase()==userWalletAddress.toUpperCase()&&getReadOnlyPlanetCryptoContract().methods.getToken(t.returnValues.token_id,!1).call(function(h,y){if(!h){currentUserLand+=parseInt(y.plots_lat.length)*PLOT_SIZE;var f=currentUserLand,C="m";99999<f&&(f/=1e3,C="km"),updateInnerHTML("yourLandSize",f+C),updateInnerHTML("yourLandSizeMobile",f+C),currentUserEmpireScore+=parseInt(t.returnValues.newEmpireScore),updateInnerHTML("yourEmpireScore",currentUserEmpireScore),updateInnerHTML("yourEmpireScoreMobile",currentUserEmpireScore)}}),t.returnValues.from.toUpperCase()==userWalletAddress.toUpperCase()&&($("#userCardFull"+t.returnValues.token_id).remove(),getReadOnlyPlanetCryptoContract().methods.getToken(t.returnValues.token_id,!1).call(function(h,y){if(!h){currentUserLand-=parseInt(y.plots_lat.length)*PLOT_SIZE;var f=currentUserLand,C="m";99999<f&&(f/=1e3,C="km"),updateInnerHTML("yourLandSize",f+C),updateInnerHTML("yourLandSizeMobile",f+C),currentUserEmpireScore-=parseInt(t.returnValues.empireScore),updateInnerHTML("yourEmpireScore",currentUserEmpireScore),updateInnerHTML("yourEmpireScoreMobile",currentUserEmpireScore)}})))),l&&l()),!0==o||processOtherStats()}function getReadOnlyPlanetCryptoContract(){return gameConnectionConnected?PlanetCryptoContractPlay:PlanetCryptoContract}function getReadOnlyPlanetCryptoCoinContract(){return gameConnectionConnected?PlanetCryptoCoinContractPlay:PlanetCryptoCoinContract}function getReadOnlyWeb3Utils(){return gameConnectionConnected?gameConnection:web3Connection}function processOtherStats(){getReadOnlyPlanetCryptoContract().methods.getAllPlayerObjectLen().call(function(t,o){t||(currentPlayers=parseInt(o),updateInnerHTML("totalPlayers",currentPlayers-1),updateInnerHTML("totalPlayersMobile",currentPlayers-1))}),updateCurrentLandPrice(),getReadOnlyPlanetCryptoContract().methods.tax_fund().call(function(t,o){t||(tax_fund=new BigNumber(o),updateInnerHTML("taxFund",getReadOnlyWeb3Utils().utils.fromWei(tax_fund.toString(),"ether").substring(0,8)),updateInnerHTML("taxFundMobile",getReadOnlyWeb3Utils().utils.fromWei(tax_fund.toString(),"ether").substring(0,8)))}),getReadOnlyPlanetCryptoContract().methods.tax_distributed().call(function(t,o){t||(tax_distributed=new BigNumber(o),updateInnerHTML("taxDist",getReadOnlyWeb3Utils().utils.fromWei(tax_distributed.toString(),"ether").substring(0,8)),updateInnerHTML("taxDistMobile",getReadOnlyWeb3Utils().utils.fromWei(tax_distributed.toString(),"ether").substring(0,8)))}),canPlay&&(getReadOnlyPlanetCryptoCoinContract().methods.balanceOf(userWalletAddress).call(function(t,o){t||(yourCOINS=parseInt(o),updateInnerHTML("yourCOINS",yourCOINS),updateInnerHTML("yourCOINSMobile",yourCOINS),getReadOnlyPlanetCryptoCoinContract().methods.allowance(userWalletAddress,contractAddress).call(function(r,l){if(!r){var d=parseInt(l);d<yourCOINS?(currentPadlockstateLocked=!0,$("#padlock").attr("src","images/padlock.png"),$("#padlockMobile").attr("src","images/padlock.png")):(currentPadlockstateLocked=!1,$("#padlock").attr("src","images/padlock_open.png"),$("#padlockMobile").attr("src","images/padlock_open.png"))}}))}),PlanetCryptoContractPlay.methods.taxEarningsAvailable().call({from:userWalletAddress},function(t,o){t||(tax_available=new BigNumber(o),updateInnerHTML("yourTaxAvailable",getReadOnlyWeb3Utils().utils.fromWei(tax_available.plus(tax_available_old).toString(),"ether").substring(0,8)),updateInnerHTML("yourTaxAvailableMobile",getReadOnlyWeb3Utils().utils.fromWei(tax_available.plus(tax_available_old).toString(),"ether").substring(0,8)),PlanetCryptoContractOld2.methods.taxEarningsAvailable().call({from:userWalletAddress},function(r,l){r||(tax_available_old=new BigNumber(l),updateInnerHTML("yourTaxAvailable",getReadOnlyWeb3Utils().utils.fromWei(tax_available.plus(tax_available_old).toString(),"ether").substring(0,8)),updateInnerHTML("yourTaxAvailableMobile",getReadOnlyWeb3Utils().utils.fromWei(tax_available.plus(tax_available_old).toString(),"ether").substring(0,8)),PlanetCryptoContractOld.methods.taxEarningsAvailable().call({from:userWalletAddress},function(d,p){d||(tax_available_old=new BigNumber(p),updateInnerHTML("yourTaxAvailable",getReadOnlyWeb3Utils().utils.fromWei(tax_available.plus(tax_available_old).toString(),"ether").substring(0,8)),updateInnerHTML("yourTaxAvailableMobile",getReadOnlyWeb3Utils().utils.fromWei(tax_available.plus(tax_available_old).toString(),"ether").substring(0,8)))}))}))}))}function setNewCardBg(){5<userWalletAddress.length&&($("#newCardHeader").css("background-color","#"+userWalletAddress.substring(userWalletAddress.length-6)),document.getElementById("newCardOwnerAddr").value=userWalletAddress,updateInnerHTML("newCardOwnerAddr",userWalletAddressShort))}function reconnectProvider(t){try{console.log("restarting..."),provider=new Web3.providers.WebsocketProvider(CONNECTION_TO_USE),provider=new Web3.providers.WebsocketProvider(CONNECTION_TO_USE),provider.on("connect",function(){console.log("WSS Reconnected"),web3Connection.setProvider(provider),restartApp()}),provider.on("error",function(o){console.log("reconnect error",o),reconnectProvider(t++)}),provider.on("end",function(o){console.log("reconnect end",o),reconnectProvider(t++)})}catch(o){console.log(o),t++,120>t?setTimeout(function(){reconnectProvider(t)},500):showError("Unable to connect to the Blockchain - please refresh this page to try again.","PlanetCrypto")}}function startApp(){!gameConnectionConnected&&shownInitialWarning,gameConnectionConnected||(PlanetCryptoContractOld=new web3Connection.eth.Contract(planetCryptoABI,contractAddressOld),PlanetCryptoContractOld2=new web3Connection.eth.Contract(planetCryptoABI,contractAddressOld2),PlanetCryptoContract=new web3Connection.eth.Contract(planetCryptoABI,contractAddress),PlanetCryptoCoinContract=new web3Connection.eth.Contract(planetCryptoCoinABI,coinsContractAddress)),"1"==isCard?(console.log(_findTokenId),getReadOnlyPlanetCryptoContract().methods.getToken(_findTokenId,!1).call(function(t,o){t?console.log(t):(tokens[_findTokenId]={token_owner:o.token_owner,current_value:o.current_value,empire_score:o.empire_score,name:getReadOnlyWeb3Utils().utils.hexToUtf8(o.name),orig_value:o.orig_value,card_size:o.plots_lat.length,plots_lat:o.plots_lat,plots_lng:o.plots_lng,buy_history:[]},showExistingCard(_findTokenId,!1))})):(processOtherStats(),setupGameStats(!0),populateGameStats(),setupLogSubscription(),0<_findTokenId.length&&showExistingCard(parseInt(_findTokenId),!0)),console.log("DONE")}function restartApp(){if(gameConnectionConnected){try{PlanetCryptoContractPlay=new gameConnection.eth.Contract(planetCryptoABI,contractAddress),PlanetCryptoContractOld=new gameConnection.eth.Contract(planetCryptoABI,contractAddressOld),PlanetCryptoContractOld2=new gameConnection.eth.Contract(planetCryptoABI,contractAddressOld2)}catch(t){}checkNetwork()}else;console.log("Contract reset"),PlanetCryptoContractOld=new web3Connection.eth.Contract(planetCryptoABI,contractAddressOld),PlanetCryptoContractOld2=new web3Connection.eth.Contract(planetCryptoABI,contractAddressOld2),PlanetCryptoContract=new web3Connection.eth.Contract(planetCryptoABI,contractAddress),PlanetCryptoCoinContract=new web3Connection.eth.Contract(planetCryptoCoinABI,coinsContractAddress);try{setupLogSubscription(),processOtherStats()}catch(t){console.log("Erorr in reset:",t)}setupGameStats(!1)}function setupLogSubscription(){!1==finalLogItemProcessed&&PlanetCryptoContractOld.getPastEvents("landPurchased",{fromBlock:6714797},function(){}).then(function(t){for(var o=t.length-1,r=0;r<t.length;r++)r==o?processLogResult(t[r],!0,!0,getOldEvents):processLogResult(t[r],!0,!1)}),logsSubscription=getReadOnlyPlanetCryptoContract().events.allEvents({fromBlock:"latest"},function(){}).on("data",function(t){processLogResult(t,!1,!1)}).on("error",function(t){console.log("logError",t)})}function getOldEvents(){PlanetCryptoContractOld2.getPastEvents("landPurchased",{fromBlock:6926277},function(){}).then(function(t){for(var o=t.length-1,r=0;r<t.length;r++)r==o?processLogResult(t[r],!0,!0,processInitBoughtCards):processLogResult(t[r],!0,!1)})}function processInitBoughtCards(){getReadOnlyPlanetCryptoContract().getPastEvents("landPurchased",{fromBlock:7049299},function(){}).then(function(t){for(var o=t.length-1,r=0;r<t.length;r++)r==o?processLogResult(t[r],!0,!0,processTransfers):processLogResult(t[r],!0,!1)})}function processInitBoughtCards2(){getReadOnlyPlanetCryptoContract().getPastEvents("cardBought",{fromBlock:6926277},function(){}).then(function(t){var o=t.length-1;console.log("lastCardSaleID",o);for(var r=0;r<t.length;r++)r==o?processLogResult(t[r],!0,!0,processTransfers):processLogResult(t[r],!0,!1)})}function processTransfers(){getReadOnlyPlanetCryptoContract().getPastEvents("Transfer",{fromBlock:7049299},function(){}).then(function(t){if(0==t.length)processTransfers2();else for(var o=t.length-1,r=0;r<t.length;r++)r==o?processLogResult(t[r],!0,!0,processTransfers2):processLogResult(t[r],!0,!1)})}function processTransfers2(){PlanetCryptoContractOld.getPastEvents("Transfer",{fromBlock:6714797},function(){}).then(function(t){if(0==t.length)updatePreviousCards();else for(var o=t.length-1,r=0;r<t.length;r++)r==o?processLogResult(t[r],!0,!0,processTransfers3):processLogResult(t[r],!0,!1)})}function processTransfers3(){PlanetCryptoContractOld2.getPastEvents("Transfer",{fromBlock:6926277},function(){}).then(function(t){if(0==t.length)updatePreviousCards();else for(var o=t.length-1,r=0;r<t.length;r++)r==o?processLogResult(t[r],!0,!0,updatePreviousCards):processLogResult(t[r],!0,!1)})}var lastBlock=0,shownInitialWarning=!1;function checkNetwork(){console.log("checkNetwork",gameConnection);try{gameConnection.eth.net.getNetworkType(function(o,r){var l="";l=o?"Error:"+o:1e12<r?"testrpc":r;var d="main";!0==useTestnet,l==d?(console.log("GETTING WALLET ADDR"),getUserWalletAddress()):(console.log("NOT CONNECTED"+d+":"+l),gameConnectionConnected=!1,setupReadOnlyWeb3())})}catch(o){console.log("NOT CONNECTED"+o),shownInitialWarning||($("#notConnectedModel").foundation("open"),shownInitialWarning=!0)}}function getUserWalletAddress(){try{gameConnection.eth.getCoinbase(function(t,o){if(!t){var r="";r=o,r?(userWalletAddress=r,shareEarnEthBtn?shareEarnEthBtn.options.url="https://planetcrypto.app/?ref="+userWalletAddress:shareEarnEthBtn=new needShareDropdown(document.getElementById("shareEarnEth"),{url:"https://planetcrypto.app/?ref="+userWalletAddress}),updateInnerHTML("refid","https://planetcrypto.app/?ref="+userWalletAddress),console.log("userWalletAddress:",userWalletAddress),r&&(userWalletAddressShort=r.substring(0,10)+"..."),canPlay=!0,setNewCardBg(),startApp(),initUserStats()):(console.log("NOT LOGGED IN!"),userWalletAddressShort="",userWalletAddress="",startApp())}else canPlay=!1,startApp()})}catch(t){console.log(t),canPlay=!1,startApp()}}function setupGameStats(){initStats()}function populateGameStats(){}var mapData={tokens:{},plots:{}},tokens={};function populateTokens(t,o,r){getReadOnlyPlanetCryptoContract().methods.getToken(t,!1).call(function l(d,p){if(!d){try{tokens[t]={token_owner:p.token_owner,current_value:p.current_value,empire_score:p.empire_score,name:getReadOnlyWeb3Utils().utils.hexToUtf8(p.name),orig_value:p.orig_value,card_size:p.plots_lat.length,plots_lat:p.plots_lat,plots_lng:p.plots_lng,buy_history:[]}}catch(u){tokens[t]={token_owner:p.token_owner,current_value:p.current_value,empire_score:p.empire_score,name:getReadOnlyWeb3Utils().utils.toAscii(p.name),orig_value:p.orig_value,card_size:p.plots_lat.length,plots_lat:p.plots_lat,plots_lng:p.plots_lng,buy_history:[]}}o&&startFireGameDataReady(),r&&r()}})}function startFireGameDataReady(){mymap?mymap.fire("gameDataReady"):setTimeout(function(){startFireGameDataReady()},2e3)}var players=[],playersSortedByEmpireScore=players.sort(function(t,o){return parseFloat(o.totalEmpireScore)-parseFloat(t.totalEmpireScore)}),playersSortedByTotalLand=players.sort(function(t,o){return parseFloat(o.totalLand)-parseFloat(t.totalLand)}),totalLandSize=0,totalTrades=0,tax_fund=new BigNumber(0),tax_distributed=new BigNumber(0),tax_available=new BigNumber(0),tax_available_old=new BigNumber(0),tax_available_old2=new BigNumber(0),totalCards=0,yourCOINS=0,currentLandPrice=new BigNumber(0);function initStats(){updateCurrentLandPrice(),getReadOnlyPlanetCryptoContract().methods.getAllPlayerObjectLen().call(function(t,o){if(t);else{currentPlayers=parseInt(o),updateInnerHTML("totalPlayers",currentPlayers-1),updateInnerHTML("totalPlayersMobile",currentPlayers-1),totalLandSize=0;for(var r=!1,l=1;l<currentPlayers;l++)getReadOnlyPlanetCryptoContract().methods.all_playerObjects(l).call(function(d,p){if(d);else if(players.push({lastAccess:p.lastAccess,playerAddress:p.playerAddress,totalEmpireScore:p.totalEmpireScore,totalLand:p.totalLand}),totalLandSize+=parseInt(p.totalLand)*PLOT_SIZE,updateTotalLandSize(),canPlay)try{if(p.playerAddress.toUpperCase()==userWalletAddress.toUpperCase()){console.log(userWalletAddress),r=!0,currentUserLand+=parseInt(p.totalLand)*PLOT_SIZE;var u=currentUserLand,g="m";99999<u&&(u/=1e3,g="km"),updateInnerHTML("yourLandSize",u+g),updateInnerHTML("yourLandSizeMobile",u+g),currentUserEmpireScore+=parseInt(p.totalEmpireScore),updateInnerHTML("yourEmpireScore",p.totalEmpireScore),updateInnerHTML("yourEmpireScoreMobile",p.totalEmpireScore)}}catch(m){}});r||(updateInnerHTML("yourLandSize","0m"),updateInnerHTML("yourLandSizeMobile","0m"),updateInnerHTML("yourEmpireScore","0"),updateInnerHTML("yourEmpireScoreMobile","0")),updateTotalLandSize(),$("#loadingDiv").addClass("hide")}}),getReadOnlyPlanetCryptoContract().methods.total_trades().call(function(t,o){t||(totalTrades=parseInt(o),updateInnerHTML("totalTrades",totalTrades),updateInnerHTML("totalTradesMobile",totalTrades))}),getReadOnlyPlanetCryptoContract().methods.tax_fund().call(function(t,o){t||(tax_fund=new BigNumber(o),updateInnerHTML("taxFund",getReadOnlyWeb3Utils().utils.fromWei(tax_fund.toString(),"ether").substring(0,8)),updateInnerHTML("taxFundMobile",getReadOnlyWeb3Utils().utils.fromWei(tax_fund.toString(),"ether").substring(0,8)))}),getReadOnlyPlanetCryptoContract().methods.tax_distributed().call(function(t,o){t||(tax_distributed=new BigNumber(o),updateInnerHTML("taxDist",getReadOnlyWeb3Utils().utils.fromWei(tax_distributed.toString(),"ether").substring(0,8)),updateInnerHTML("taxDistMobile",getReadOnlyWeb3Utils().utils.fromWei(tax_distributed.toString(),"ether").substring(0,8)))})}function initUserStats(){canPlay&&(getReadOnlyPlanetCryptoCoinContract().methods.balanceOf(userWalletAddress).call(function(t,o){t||(yourCOINS=parseInt(o),updateInnerHTML("yourCOINS",yourCOINS),updateInnerHTML("yourCOINSMobile",yourCOINS),getReadOnlyPlanetCryptoCoinContract().methods.allowance(userWalletAddress,contractAddress).call(function(r,l){if(!r){var d=parseInt(l);d<yourCOINS?(currentPadlockstateLocked=!0,$("#padlock").attr("src","images/padlock.png"),$("#padlockMobile").attr("src","images/padlock.png")):(currentPadlockstateLocked=!1,$("#padlock").attr("src","images/padlock_open.png"),$("#padlockMobile").attr("src","images/padlock_open.png"))}}))}),PlanetCryptoContractPlay.methods.taxEarningsAvailable().call({from:userWalletAddress},function(t,o){t||(tax_available=new BigNumber(o),updateInnerHTML("yourTaxAvailable",getReadOnlyWeb3Utils().utils.fromWei(tax_available.plus(tax_available_old.plus(tax_available_old2)).toString(),"ether").substring(0,8)),updateInnerHTML("yourTaxAvailableMobile",getReadOnlyWeb3Utils().utils.fromWei(tax_available.plus(tax_available_old.plus(tax_available_old2)).toString(),"ether").substring(0,8)),PlanetCryptoContractOld2.methods.taxEarningsAvailable().call({from:userWalletAddress},function(r,l){r||(tax_available_old2=new BigNumber(l),updateInnerHTML("yourTaxAvailable",getReadOnlyWeb3Utils().utils.fromWei(tax_available.plus(tax_available_old.plus(tax_available_old2)).toString(),"ether").substring(0,8)),updateInnerHTML("yourTaxAvailableMobile",getReadOnlyWeb3Utils().utils.fromWei(tax_available.plus(tax_available_old.plus(tax_available_old2)).toString(),"ether").substring(0,8)),PlanetCryptoContractOld.methods.taxEarningsAvailable().call({from:userWalletAddress},function(d,p){d||(tax_available_old=new BigNumber(p),updateInnerHTML("yourTaxAvailable",getReadOnlyWeb3Utils().utils.fromWei(tax_available.plus(tax_available_old.plus(tax_available_old2)).toString(),"ether").substring(0,8)),updateInnerHTML("yourTaxAvailableMobile",getReadOnlyWeb3Utils().utils.fromWei(tax_available.plus(tax_available_old.plus(tax_available_old2)).toString(),"ether").substring(0,8)))}))}))}))}function updateCurrentLandPrice(t){getReadOnlyPlanetCryptoContract().methods.current_plot_price().call(function(o,r){if(o);else{currentLandPrice=new BigNumber(r),updateInnerHTML("currentLandPrice",getReadOnlyWeb3Utils().utils.fromWei(currentLandPrice.toString(),"ether").substring(0,8));try{t&&t()}catch(l){}}})}function updateTotalLandSize(){var t=totalLandSize,o="m";99999<totalLandSize&&(t/=1e3),updateInnerHTML("totalLandSize",t+o),updateInnerHTML("totalLandSizeMobile",t+o),700<totalLandSize/20&&updateInnerHTML("startPlots",totalLandSize/20)}function withdrawFunds(){return canPlay?tax_available.eq(0)&&tax_available_old.eq(0)&&tax_available_old2.eq(0)?void showError("You don't have any have tax earnings available at the moment.<br/><br/>The more land you own, the more property tax you'll ean - tax is earned instantly someone else buys land!<br/><br/>For more information check our the CryptoLand Guide (Click the blue help button above).","No Tax Earnings"):void(tax_available.gt(0)?PlanetCryptoContractPlay.methods.withdrawTaxEarning().estimateGas({from:userWalletAddress},function(t,o){t?(console.log(t),showError("Unable to contact the blockchain - please try again.","Planet Crypto")):($.toast({heading:"Sending Transaction",text:"Check your Ethereum Wallet to complete the transaction",icon:"info",allowToastClose:!0,position:"bottom-right",hideAfter:TOAST_HIDE_DELAY,showHideTransition:TOAST_HIDE_TRANSITION}),PlanetCryptoContractPlay.methods.withdrawTaxEarning().send({from:userWalletAddress,gas:o,gasPrice:useGasPrice},function(r,l){if(r)$.toast({heading:"Withdrawal Cancelled",text:"Your withdrawel was cancelled and no GAS was spent - please try again!",icon:"info",allowToastClose:!0,position:"bottom-right",hideAfter:TOAST_HIDE_DELAY,showHideTransition:TOAST_HIDE_TRANSITION});else{var d="";d+="<p style=\"font-size: 10pt;\"><i>Please Note: Your FUNDS will not appear instantly - it depends how busy the Ethereum network is. Please monitor with Etherscan.</i></p>",d+="<p style=\"font-size: 10pt;\"><a href=\"https://etherscan.io/tx/"+l+"\" target=\"_new\">View Transaction on Etherscan</a></p>",d+="<p style=\"font-size: 10pt;\">Share your Master Node link to earn 5%!</p>",d+="<p>",d+="<strong style=\"font-size: 12pt;\">Your Referral Master Node Link</strong>",d+="</p>",d+="<p style=\"font-size: 10pt;\">",d+="<code style=\"font-size: 8pt;\">https://planetcrypto.app/?ref="+userWalletAddress+"</code>",d+="</p>",d+="<p style=\"font-size: 10pt;\">",d+=" For every new player you refer on - you will earn 5% from purchases as an instant bonus!",d+="</p>",d+="<p style=\"font-size: 10pt;\"><b>The more players we have - the more profits you share!</b></p>",showError(d,"Withdrawal Complete"),tax_available=new BigNumber(0),updateInnerHTML("yourTaxAvailable",getReadOnlyWeb3Utils().utils.fromWei(tax_available.plus(tax_available_old).toString(),"ether").substring(0,8)),updateInnerHTML("yourTaxAvailableMobile",getReadOnlyWeb3Utils().utils.fromWei(tax_available.plus(tax_available_old).toString(),"ether").substring(0,8))}}))}):tax_available_old.gt(0)?PlanetCryptoContractOld.methods.withdrawTaxEarning().estimateGas({from:userWalletAddress},function(t,o){t?(console.log(t),showError("Unable to contact the blockchain - please try again.","Planet Crypto")):($.toast({heading:"Sending Transaction",text:"Check your Ethereum Wallet to complete the transaction",icon:"info",allowToastClose:!0,position:"bottom-right",hideAfter:TOAST_HIDE_DELAY,showHideTransition:TOAST_HIDE_TRANSITION}),PlanetCryptoContractOld.methods.withdrawTaxEarning().send({from:userWalletAddress,gas:o,gasPrice:useGasPrice},function(r,l){if(r)$.toast({heading:"Withdrawal Cancelled",text:"Your withdrawel was cancelled and no GAS was spent - please try again!",icon:"info",allowToastClose:!0,position:"bottom-right",hideAfter:TOAST_HIDE_DELAY,showHideTransition:TOAST_HIDE_TRANSITION});else{var d="";d+="<p style=\"font-size: 10pt;\"><i>Please Note: Your FUNDS will not appear instantly - it depends how busy the Ethereum network is. Please monitor with Etherscan.</i></p>",d+="<p style=\"font-size: 10pt;\"><a href=\"https://etherscan.io/tx/"+l+"\" target=\"_new\">View Transaction on Etherscan</a></p>",d+="<p style=\"font-size: 10pt;\">Share your Master Node link to earn 5%!</p>",d+="<p>",d+="<strong style=\"font-size: 12pt;\">Your Referral Master Node Link</strong>",d+="</p>",d+="<p style=\"font-size: 10pt;\">",d+="<code style=\"font-size: 8pt;\">https://planetcrypto.app/?ref="+userWalletAddress+"</code>",d+="</p>",d+="<p style=\"font-size: 10pt;\">",d+=" For every new player you refer on - you will earn 5% from purchases as an instant bonus!",d+="</p>",d+="<p style=\"font-size: 10pt;\"><b>The more players we have - the more profits you share!</b></p>",showError(d,"Withdrawal Complete"),tax_available_old=new BigNumber(0),updateInnerHTML("yourTaxAvailable",getReadOnlyWeb3Utils().utils.fromWei(tax_available.plus(tax_available_old).toString(),"ether").substring(0,8)),updateInnerHTML("yourTaxAvailableMobile",getReadOnlyWeb3Utils().utils.fromWei(tax_available.plus(tax_available_old).toString(),"ether").substring(0,8))}}))}):PlanetCryptoContractOld2.methods.withdrawTaxEarning().estimateGas({from:userWalletAddress},function(t,o){t?(console.log(t),showError("Unable to contact the blockchain - please try again.","Planet Crypto")):($.toast({heading:"Sending Transaction",text:"Check your Ethereum Wallet to complete the transaction",icon:"info",allowToastClose:!0,position:"bottom-right",hideAfter:TOAST_HIDE_DELAY,showHideTransition:TOAST_HIDE_TRANSITION}),PlanetCryptoContractOld2.methods.withdrawTaxEarning().send({from:userWalletAddress,gas:o,gasPrice:useGasPrice},function(r,l){if(r)$.toast({heading:"Withdrawal Cancelled",text:"Your withdrawel was cancelled and no GAS was spent - please try again!",icon:"info",allowToastClose:!0,position:"bottom-right",hideAfter:TOAST_HIDE_DELAY,showHideTransition:TOAST_HIDE_TRANSITION});else{var d="";d+="<p style=\"font-size: 10pt;\"><i>Please Note: Your FUNDS will not appear instantly - it depends how busy the Ethereum network is. Please monitor with Etherscan.</i></p>",d+="<p style=\"font-size: 10pt;\"><a href=\"https://etherscan.io/tx/"+l+"\" target=\"_new\">View Transaction on Etherscan</a></p>",d+="<p style=\"font-size: 10pt;\">Share your Master Node link to earn 5%!</p>",d+="<p>",d+="<strong style=\"font-size: 12pt;\">Your Referral Master Node Link</strong>",d+="</p>",d+="<p style=\"font-size: 10pt;\">",d+="<code style=\"font-size: 8pt;\">https://planetcrypto.app/?ref="+userWalletAddress+"</code>",d+="</p>",d+="<p style=\"font-size: 10pt;\">",d+=" For every new player you refer on - you will earn 5% from purchases as an instant bonus!",d+="</p>",d+="<p style=\"font-size: 10pt;\"><b>The more players we have - the more profits you share!</b></p>",showError(d,"Withdrawal Complete"),tax_available_old=new BigNumber(0),updateInnerHTML("yourTaxAvailable",getReadOnlyWeb3Utils().utils.fromWei(tax_available.plus(tax_available_old).toString(),"ether").substring(0,8)),updateInnerHTML("yourTaxAvailableMobile",getReadOnlyWeb3Utils().utils.fromWei(tax_available.plus(tax_available_old).toString(),"ether").substring(0,8))}}))})):void $("#notConnectedModel").foundation("open")}function destroyCard(){return canPlay?void(showProcessing(),$.getJSON(ethGasStationAPI,function(t){if(isNaN(t.average))console.log("Unable to access ethgasstation"),destoryCardProcess();else{var o=new BigNumber(t.average).times(1e8);console.log("New Gas:",o.toString()),useGasPrice=parseInt(o.toString()),destoryCardProcess()}})):void $("#notConnectedModel").foundation("open")}function destoryCardProcess(){PlanetCryptoContractPlay.methods.burn(existingCardTokenId).estimateGas({from:userWalletAddress},function(t,o){t?(console.log(t),showError("Destory action not possible - make sure you own this card first.","Planet Crypto"),hideProcessing()):($.toast({heading:"Sending Transaction",text:"Check your Ethereum Wallet to complete the transaction",icon:"info",allowToastClose:!0,position:"bottom-right",hideAfter:TOAST_HIDE_DELAY,showHideTransition:TOAST_HIDE_TRANSITION}),PlanetCryptoContractPlay.methods.burn(existingCardTokenId).send({from:userWalletAddress,gas:o,gasPrice:useGasPrice},function(r,l){if(hideProcessing(),r)$.toast({heading:"Destory Action Cancelled",text:"Your destroy action was cancelled and no ETH was spent this time - please try again!",icon:"info",allowToastClose:!0,position:"bottom-right",hideAfter:TOAST_HIDE_DELAY,showHideTransition:TOAST_HIDE_TRANSITION});else{var d="";d+="<p style=\"font-size: 10pt;\"><i>Please Note: Your Destroy Action and your new PlaneteCOINs will not appear instantly - it depends how busy the Ethereum network is. Please monitor with Etherscan.</i></p>",d+="<p style=\"font-size: 10pt;\"><a href=\"https://etherscan.io/tx/"+l+"\" target=\"_new\">View Transaction on Etherscan</a></p>",d+="<p style=\"font-size: 10pt;\">Share your Master Node link to earn 5%!</p>",d+="<p>",d+="<strong style=\"font-size: 12pt;\">Your Referral Master Node Link</strong>",d+="</p>",d+="<p style=\"font-size: 10pt;\">",d+="<code style=\"font-size: 8pt;\">https://planetcrypto.app/?ref="+userWalletAddress+"</code>",d+="</p>",d+="<p style=\"font-size: 10pt;\">",d+=" For every new player you refer on - you will earn 5% from purchases as an instant bonus!",d+="</p>",d+="<p style=\"font-size: 10pt;\"><b>The more players we have - the more profits you share!</b></p>",showError(d,"Purchase Complete"),ga("send","event","BuyTools","DestroyExistingCardComplete")}}))})}function buyExistingCard(){return canPlay?void(showProcessing(),$.getJSON(ethGasStationAPI,function(t){if(isNaN(t.average))console.log("Unable to access ethgasstation"),buyExistingCardProcess();else{var o=new BigNumber(t.average).times(1e8);console.log("New Gas:",o.toString()),useGasPrice=parseInt(o.toString()),buyExistingCardProcess()}})):void $("#notConnectedModel").foundation("open")}function buyExistingCardProcess(){getReadOnlyWeb3Utils().utils.isAddress(_referer)||(_referer=getReadOnlyWeb3Utils().utils.toChecksumAddress("0x0000000000000000000000000000000000000000")),PlanetCryptoContractPlay.methods.buyCard(existingCardTokenId,_referer).estimateGas({from:userWalletAddress,value:existingCardPaymentAmount},function(t,o){t?(console.log(t),showError("Purchase not possible - make sure your not trying to buy your own land!","Planet Crypto"),hideProcessing()):($.toast({heading:"Sending Transaction",text:"Check your Ethereum Wallet to complete the transaction",icon:"info",allowToastClose:!0,position:"bottom-right",hideAfter:TOAST_HIDE_DELAY,showHideTransition:TOAST_HIDE_TRANSITION}),PlanetCryptoContractPlay.methods.buyCard(existingCardTokenId,_referer).send({from:userWalletAddress,gas:o,gasPrice:useGasPrice,value:existingCardPaymentAmount},function(r,l){if(hideProcessing(),r)$.toast({heading:"Purchase Cancelled",text:"Your purchase was cancelled and no ETH was spent this time - please try again!",icon:"info",allowToastClose:!0,position:"bottom-right",hideAfter:TOAST_HIDE_DELAY,showHideTransition:TOAST_HIDE_TRANSITION});else{var d="";d+="<p style=\"font-size: 10pt;\"><i>Please Note: Your Purchase will not appear instantly - it depends how busy the Ethereum network is. Please monitor with Etherscan.</i></p>",d+="<p style=\"font-size: 10pt;\"><a href=\"https://etherscan.io/tx/"+l+"\" target=\"_new\">View Transaction on Etherscan</a></p>",d+="<p style=\"font-size: 10pt;\">Share your Master Node link to earn 5%!</p>",d+="<p>",d+="<strong style=\"font-size: 12pt;\">Your Referral Master Node Link</strong>",d+="</p>",d+="<p style=\"font-size: 10pt;\">",d+="<code style=\"font-size: 8pt;\">https://planetcrypto.app/?ref="+userWalletAddress+"</code>",d+="</p>",d+="<p style=\"font-size: 10pt;\">",d+=" For every new player you refer on - you will earn 5% from purchases as an instant bonus!",d+="</p>",d+="<p style=\"font-size: 10pt;\"><b>The more players we have - the more profits you share!</b></p>",showError(d,"Purchase Complete"),ga("send","event","BuyTools","BuyExistingCardComplete"),gtag_report_conversion2()}}))})}function buyWithEthUpsell(){var t=parseInt(rectsToBuyLen());console.log("UPSELL",t),3<t&&10>t?(updateInnerHTML("upsellCount",10-t),updateInnerHTML("upsellTokenCount",1),$("#buyUpsell").foundation("open")):12<t&&20>t?(updateInnerHTML("upsellCount",20-t),updateInnerHTML("upsellTokenCount",2),$("#buyUpsell").foundation("open")):23<t&&30>t?(updateInnerHTML("upsellCount",30-t),updateInnerHTML("upsellTokenCount",3),$("#buyUpsell").foundation("open")):buyWithEth()}function buyWithEth(){return canPlay?void(showProcessing(),$.getJSON(ethGasStationAPI,function(t){if(isNaN(t.average))console.log("Unable to access ethgasstation"),buyWithEthProcess();else{var o=new BigNumber(t.average).times(1e8);console.log("New Gas:",o.toString()),useGasPrice=parseInt(o.toString()),buyWithEthProcess()}})):void $("#notConnectedModel").foundation("open")}function buyWithEthProcess(){var t=document.getElementById("newCardName").value;if(4>t.length)return showError("Card Names must be at least 4 characters long","Name too short"),void hideProcessing();if(32<byteCount(t))return showError("Card Names must be less than 33 Bytes in size.<br/><br/>Yours is currently: "+byteCount(t)+"<br/><br/>Please reduce the name size","Name Too Long!"),void hideProcessing();var o=[],r=[];for(key in rectsToBuy)o.push(parseInt(new BigNumber(hardFixed(rectsToBuy[key].lat,5)).times(1e6).toFixed(0))),r.push(parseInt(new BigNumber(hardFixed(rectsToBuy[key].lng,5)).times(1e6).toFixed(0)));getReadOnlyWeb3Utils().utils.isAddress(_referer)||(console.log("Invalid Referer"),_referer=getReadOnlyWeb3Utils().utils.toChecksumAddress("0x0000000000000000000000000000000000000000")),updateCurrentLandPrice(function(){var l=currentLandPrice*o.length,d;try{d=getReadOnlyWeb3Utils().utils.utf8ToHex(t)}catch(p){d=getReadOnlyWeb3Utils().utils.fromAscii(t)}console.log("ENCODED NAME:",d),console.log("_lat",o),console.log("_lng",r),PlanetCryptoContractPlay.methods.buyLand(d,o,r,_referer).estimateGas({from:userWalletAddress,value:l},function(p,u){p?(console.log(p),hideProcessing(),showError("Purchase not possible - check your not trying to buy part of someone elses land!","Planet Crypto")):($.toast({heading:"Sending Transaction",text:"Check your Ethereum Wallet to complete the transaction",icon:"info",allowToastClose:!0,position:"bottom-right",hideAfter:TOAST_HIDE_DELAY,showHideTransition:TOAST_HIDE_TRANSITION}),PlanetCryptoContractPlay.methods.buyLand(d,o,r,_referer).send({from:userWalletAddress,gas:u,gasPrice:useGasPrice,value:l},function(g,m){if(hideProcessing(),g)$.toast({heading:"Purchase Cancelled",text:"Your purchase was cancelled and no ETH was spent this time - please try again!",icon:"info",allowToastClose:!0,position:"bottom-right",hideAfter:TOAST_HIDE_DELAY,showHideTransition:TOAST_HIDE_TRANSITION});else{var h="";h+="<p style=\"font-size: 10pt;\"><i>Please Note: Your Purchase will not appear instantly - it depends how busy the Ethereum network is. Please monitor with Etherscan.</i></p>",h+="<p style=\"font-size: 10pt;\"><a href=\"https://etherscan.io/tx/"+m+"\" target=\"_new\">View Transaction on Etherscan</a></p>",h+="<p style=\"font-size: 10pt;\">Share your Master Node link to earn 5%!</p>",h+="<p>",h+="<strong style=\"font-size: 12pt;\">Your Referral Master Node Link</strong>",h+="</p>",h+="<p style=\"font-size: 10pt;\">",h+="<code style=\"font-size: 8pt;\">https://planetcrypto.app/?ref="+userWalletAddress+"</code>",h+="</p>",h+="<p style=\"font-size: 10pt;\">",h+=" For every new player you refer on - you will earn 5% from purchases as an instant bonus!",h+="</p>",h+="<p style=\"font-size: 10pt;\"><b>The more players we have - the more profits you share!</b></p>",showError(h,"Purchase Complete"),resetSelectedRects(),ga("send","event","BuyTools","BuyWithEthComplete"),gtag_report_conversion()}}))})})}function buyWithTokens(){return canPlay?void(showProcessing(),$.getJSON(ethGasStationAPI,function(t){if(isNaN(t.average))console.log("Unable to access ethgasstation"),buyWithTokenProcess();else{var o=new BigNumber(t.average).times(1e8);console.log("New Gas:",o.toString()),useGasPrice=parseInt(o.toString()),buyWithTokenProcess()}})):void $("#notConnectedModel").foundation("open")}function buyWithTokenProcess(){var t=document.getElementById("newCardName").value;if(4>t.length)return showError("Card Names must be at least 4 characters long","Name too short"),void hideProcessing();if(32<byteCount(t))return showError("Card Names must be less than 33 Bytes in size.<br/><br/>Yours is currently: "+byteCount(t)+"<br/><br/>Please reduce the name size","Name Too Long!"),void hideProcessing();var o=[],r=[];for(key in rectsToBuy)o.push(parseInt(new BigNumber(hardFixed(rectsToBuy[key].lat,5)).times(1e6).toFixed(0))),r.push(parseInt(new BigNumber(hardFixed(rectsToBuy[key].lng,5)).times(1e6).toFixed(0)));getReadOnlyWeb3Utils().utils.isAddress(_referer)||(_referer=getReadOnlyWeb3Utils().utils.toChecksumAddress("0x0000000000000000000000000000000000000000"));var l;try{l=getReadOnlyWeb3Utils().utils.utf8ToHex(t)}catch(d){l=getReadOnlyWeb3Utils().utils.fromAscii(t)}PlanetCryptoContractPlay.methods.buyLandWithTokens(l,o,r).estimateGas({from:userWalletAddress},function(d,p){d?(console.log(d),showError("Purchase not possible - check you have UNLOCKED your PlanetCOINS tokens and that you have 1 Token for each plot of Land.","Planet Crypto"),hideProcessing()):($.toast({heading:"Sending Transaction",text:"Check your Ethereum Wallet to complete the transaction",icon:"info",allowToastClose:!0,position:"bottom-right",hideAfter:TOAST_HIDE_DELAY,showHideTransition:TOAST_HIDE_TRANSITION}),PlanetCryptoContractPlay.methods.buyLandWithTokens(l,o,r).send({from:userWalletAddress,gas:p,gasPrice:useGasPrice},function(u,g){if(hideProcessing(),u)$.toast({heading:"Purchase Cancelled",text:"Your purchase was cancelled and no PlanetCOINS were spent this time - please try again!",icon:"info",allowToastClose:!0,position:"bottom-right",hideAfter:TOAST_HIDE_DELAY,showHideTransition:TOAST_HIDE_TRANSITION});else{var m="";m+="<p style=\"font-size: 10pt;\"><i>Please Note: Your Purchase will not appear instantly - it depends how busy the Ethereum network is. Please monitor with Etherscan.</i></p>",m+="<p style=\"font-size: 10pt;\"><a href=\"https://etherscan.io/tx/"+g+"\" target=\"_new\">View Transaction on Etherscan</a></p>",m+="<p style=\"font-size: 10pt;\">Share your Master Node link to earn 5%!</p>",m+="<p>",m+="<strong style=\"font-size: 12pt;\">Your Referral Master Node Link</strong>",m+="</p>",m+="<p style=\"font-size: 10pt;\">",m+="<code style=\"font-size: 8pt;\">https://planetcrypto.app/?ref="+userWalletAddress+"</code>",m+="</p>",m+="<p style=\"font-size: 10pt;\">",m+=" For every new player you refer on - you will earn 5% from purchases as an instant bonus!",m+="</p>",m+="<p style=\"font-size: 10pt;\"><b>The more players we have - the more profits you share!</b></p>",showError(m,"Purchase Complete"),resetSelectedRects(),ga("send","event","BuyTools","BuyWithTokensComplete")}}))})}var currentPadlockstateLocked=!0;function switchCOINlockstatus(){if(!canPlay)return $("#notConnectedModel").foundation("open"),void(shownInitialWarning=!0);var t;t=currentPadlockstateLocked?yourCOINS:0,PlanetCryptoCoinContractPlay.methods.approve(contractAddress,t).estimateGas({from:userWalletAddress},function(o,r){o?(console.log(o),showError("Unable to contact blockchain - please refresh and try again","Planet Crypto")):($.toast({heading:"Altering PlanetCOINS State",text:"Check your Ethereum Wallet to complete the transaction",icon:"info",allowToastClose:!0,position:"bottom-right",hideAfter:TOAST_HIDE_DELAY,showHideTransition:TOAST_HIDE_TRANSITION}),PlanetCryptoCoinContractPlay.methods.approve(contractAddress,t).send({from:userWalletAddress,gas:r,gasPrice:useGasPrice},function(l,d){if(l)$.toast({heading:"Altering Transaction Cancelled",text:"Your transaction was cancelled and no ETH was spent this time - please try again!",icon:"info",allowToastClose:!0,position:"bottom-right",hideAfter:TOAST_HIDE_DELAY,showHideTransition:TOAST_HIDE_TRANSITION});else{var p="";p+="<p style=\"font-size: 10pt;\"><i>Please Note: Your Transaction will not appear instantly - it depends how busy the Ethereum network is. Please monitor with Etherscan.</i></p>",p+="<p style=\"font-size: 10pt;\"><a href=\"https://etherscan.io/tx/"+d+"\" target=\"_new\">View Transaction on Etherscan</a></p>",p+="<p style=\"font-size: 10pt;\">Share your Master Node link to earn 5%!</p>",p+="<p>",p+="<strong style=\"font-size: 12pt;\">Your Referral Master Node Link</strong>",p+="</p>",p+="<p style=\"font-size: 10pt;\">",p+="<code style=\"font-size: 8pt;\">https://planetcrypto.app/?ref="+userWalletAddress+"</code>",p+="</p>",p+="<p style=\"font-size: 10pt;\">",p+=" For every new player you refer on - you will earn 5% from purchases as an instant bonus!",p+="</p>",p+="<p style=\"font-size: 10pt;\"><b>The more players we have - the more profits you share!</b></p>",showError(p,"Transaction Sent"),currentPadlockstateLocked?($("#padlock").attr("src","images/padlock_open.png"),$("#padlockMobile").attr("src","images/padlock_open.png"),currentPadlockstateLocked=!1):($("#padlock").attr("src","images/padlock.png"),$("#padlockMobile").attr("src","images/padlock.png"),currentPadlockstateLocked=!0)}}))})}var QUERY_CACHE_TIME=15000,queryCache={};function queryMap(t){var p,u=1e6,g=2;18==t&&(g=0,p=0),17==t&&(g=0,p=0),16==t&&(p=4,u=1e4),15==t&&(p=3,u=1e3,g=3),15>t,14==t&&(p=3,u=1e3,g=3),13==t&&(p=2,u=100,g=4);var m=mymap.getBounds(),h=[];return 0==p,Object.keys(tokens).forEach(function(y){var C=L.latLng([parseFloat(hardFixed(tokens[y].plots_lat[0]/1e6,5)),parseFloat(hardFixed(tokens[y].plots_lng[0]/1e6,5))]);if(!m.contains(C));else if(0==p)for(var _,v=y,w=tokens[y],k=0;k<w.card_size;k++)_=L.latLng([parseFloat(hardFixed(w.plots_lat[k]/1e6,5)),parseFloat(hardFixed(w.plots_lng[k]/1e6,5))]),h.push({token_id:v,latLngPoint:_,token:w});else{var v=y,w=tokens[y];if(markersAllLvls[t+":"+v])markersAllLvls[t+":"+v].addTo(mymap);else{var T=L.ExtraMarkers.icon({icon:"fa-flag",markerColor:"white",iconColor:"#"+w.token_owner.substring(w.token_owner.length-6),shape:"square",prefix:"fa"}),S=L.marker(C,{icon:T}),E="<span style='font-size:0.9em;'><b style='font-size:1.2em;'>Token: #"+v+" ~ "+w.name+"</b><br/>";E+="<b>Owner:</b><br/> "+w.token_owner+"...",E+="<br/><b>Empire Score:</b> "+w.empire_score,E+="<br/><b>Bought At:</b> "+getReadOnlyWeb3Utils().utils.fromWei(w.current_value.toString(),"ether").substring(0,8)+" ETH",E+="<br/>~ Run a hostile take-over for: <strong>"+getReadOnlyWeb3Utils().utils.fromWei((w.current_value*CURRENT_RESALE_MULTIPLIER).toString(),"ether").substring(0,8),E+=" ETH</strong>",E+="<br/>~ Increasing it's EMPIRE SCORE to: <strong>"+w.empire_score*CURRENT_EMPIRE_MULTIPLIER+"</strong>",E+="<br/><center><strong>~ Click for Full Card Details ~</strong></center></span>",S.bindTooltip(E),S.on("click",function(){showExistingCard(v,!0)}),S.addTo(mymap),markersAllLvls[t+":"+v]=S}}}),void(0==p&&Object.keys(lightGrids[t].cellDetails).forEach(function(y){for(var C=0;C<h.length;C++)if(lightGrids[t].cellDetails[y].bounds.contains(h[C].latLngPoint)){var v=L.rectangle(lightGrids[t].cellDetails[y].bounds,{color:"#"+h[C].token.token_owner.substring(h[C].token.token_owner.length-6),weight:2,fillOpacity:0.5});lightGrids[t].rects[lightGrids[t].cellDetails[y].key].token_id=h[C].token_id;var w="<b style='font-size:1.2em;'>["+h[C].token_id+"] "+h[C].token.name+"</b><br/>";w+="<b>Owned By:</b><br/> "+h[C].token.token_owner,w+="<br/><b>Total Size:</b> "+h[C].token.card_size*PLOT_SIZE+"m<sup>2</sup>",w+="<br/><b>Empire Score:</b> "+h[C].token.empire_score,w+="<br/><b>Bought At:</b> "+getReadOnlyWeb3Utils().utils.fromWei(h[C].token.current_value.toString(),"ether").substring(0,8)+" ETH",w+="<br/>~ You can run a hostile take-over and own this card for: "+getReadOnlyWeb3Utils().utils.fromWei((h[C].token.current_value*CURRENT_RESALE_MULTIPLIER).toString(),"ether").substring(0,8),w+=" ETH.",w+="<br/>~ Doing so will also increase it's EMPIRE SCORE to: "+h[C].token.empire_score*CURRENT_EMPIRE_MULTIPLIER,w+="<br/> &nbsp;&nbsp; - increasing your score whilst reducing the previous owners!",w+="<br/><br/><center><span class='smallTxt'><strong>Click for full card details</strong></span></center>",v.bindTooltip(w);try{}catch(k){}v.token_id=h[C].token_id,v.on("click",function(k){showExistingCard(k.sourceTarget.token_id,!0)}),v.addTo(mymap),rectsDisplayedKeys.push(v);break}}))}var rectsDisplayedKeys={},markersAllLvls={};function manageCaches(){}function clearMarkers(){for(var t in markersAllLvls)markersAllLvls[t].removeFrom(mymap)}function clearGrids(){}function clearDisplayedKeys(){Object.keys(rectsDisplayedKeys).forEach(function(t,o){rectsDisplayedKeys[o].removeFrom(mymap),delete rectsDisplayedKeys[t]}),rectsDisplayedKeys=[]}function clearSelectedRects(){(17==mymap.getZoom()||18==mymap.getZoom())&&Object.keys(lightGrids[mymap.getZoom()].rectList).forEach(function(t){lightGrids[mymap.getZoom()].rectList[t].removeFrom(mymap)})}function resetSelectedRects(){try{Object.keys(lightGrids[17].rectList).forEach(function(t){lightGrids[17].rectList[t].removeFrom(mymap)})}catch(t){}try{Object.keys(lightGrids[18].rectList).forEach(function(t){lightGrids[18].rectList[t].removeFrom(mymap)})}catch(t){}rectsToBuy={},actionMode="",allowedPlotsCircle&&allowedPlotsCircle.remove(),clearNewBuyCard(),updateNewCard()}var existingCardStartPoint,existingCardTokenId=0,existingCardPaymentAmount=0,existingCardOwned=!1,shareDropdown;function showExistingCard(t,o){existingCardTokenId=t,tokens[t]||(console.log("Token not loaded..."),getReadOnlyPlanetCryptoContract().methods.getTokenEnhanced(t,!1).call(function(p,u){if(!p){try{tokens[t]={token_owner:u.token_owner,current_value:u.current_value,empire_score:u.empire_score,name:getReadOnlyWeb3Utils().utils.hexToUtf8(u.name),orig_value:u.orig_value,card_size:u.plots_lat.length,plots_lat:u.plots_lat,plots_lng:u.plots_lng,buy_history:[]}}catch(g){tokens[t]={token_owner:u.token_owner,current_value:u.current_value,empire_score:u.empire_score,name:getReadOnlyWeb3Utils().utils.toAscii(u.name),orig_value:u.orig_value,card_size:u.plots_lat.length,plots_lat:u.plots_lat,plots_lng:u.plots_lng,buy_history:[]}}setTimeout(function(){showExistingCard(t,o)},1e3)}}));var r=tokens[t];if(r){_findTokenId="",$("#existingCardHeader").css("background-color","#"+r.token_owner.substring(r.token_owner.length-6)),isMobile?updateInnerHTML("existingCardOwner",r.token_owner.substring(0,10)+"..."):updateInnerHTML("existingCardOwner",r.token_owner.substring(0,20)+"..."),existingCardOwned=r.token_owner.toUpperCase()==userWalletAddress.toUpperCase(),document.getElementById("existingCardOwner").value=r.token_owner,1<r.plots_lng.length?updateInnerHTML("existingCardTotalPlots",r.plots_lng.length+" Plots"):updateInnerHTML("existingCardTotalPlots",r.plots_lng.length+" Plot"),document.getElementById("destoryCOINs")&&(updateInnerHTML("destoryCOINs",r.plots_lng.length),updateInnerHTML("destoryCOINs2",r.plots_lng.length));var l=parseInt(r.plots_lng.length)*PLOT_SIZE,d="m";99999<l&&(l/=1e3,d="km"),updateInnerHTML("existingCardTotalPlotsSize",l+d),updateInnerHTML("existingCardsCost",getReadOnlyWeb3Utils().utils.fromWei(r.current_value.toString(),"ether").substring(0,8)),existingCardPaymentAmount=r.current_value*CURRENT_RESALE_MULTIPLIER,updateInnerHTML("existingCardBuyPrice",getReadOnlyWeb3Utils().utils.fromWei((r.current_value*CURRENT_RESALE_MULTIPLIER).toString(),"ether").substring(0,8)),document.getElementById("destoryCost")&&updateInnerHTML("destoryCost",getReadOnlyWeb3Utils().utils.fromWei((r.current_value*CURRENT_RESALE_MULTIPLIER).toString(),"ether").substring(0,8)),updateInnerHTML("existingCardNewEmpireScore",r.empire_score*CURRENT_EMPIRE_MULTIPLIER),updateInnerHTML("existingCardBadge",pad(r.empire_score,5)),$("#existingCardBadge").attr("title","EMPIRE SCORE:"+pad(r.empire_score,5)),updateInnerHTML("existingCardName",r.name),updateInnerHTML("existingCardStartPoint",r.plots_lat[0]/1e6+","+r.plots_lng[0]/1e6),existingCardStartPoint=L.latLng(r.plots_lat[0]/1e6,r.plots_lng[0]/1e6),$("#existingCardImg").css("background-image","url(https://api.planetcrypto.app/img/"+t+")"),$("#existingCardImgBack2").css("background-image","url(https://api.planetcrypto.app/img/"+t+")"),o&&mymap.flyTo(existingCardStartPoint,MIN_BUY_LVL),share_url="https://planetcrypto.app/token/"+t,$("meta[property='og:url']").attr("content",share_url),share_title="PlanetCrypto Card: "+r.name+" - Where will you buy? #blockchain #blockchaingames #crypto ",$("meta[property=\"og:title\"]").attr("content",share_title),share_description=r.name+" @ "+hardFixed(existingCardStartPoint.lat,4)+","+hardFixed(existingCardStartPoint.lng,4),share_description+=", owned by: "+r.token_owner+" ",$("meta[property='og:description']").attr("content",share_description),$("meta[property='og:image']").attr("content","https://api.planetcrypto.app/img/"+t),shareDropdown?(shareDropdown.options.title=getShareTitle(),shareDropdown.options.url=getShareURL(),shareDropdown.options.image=getShareImage(),shareDropdown.options.description=getShareDescription()):shareDropdown=new needShareDropdown(document.getElementById("shareExistingCard"),{shareButtonClass:!1,iconStyle:"default",boxForm:"horizontal",buttonText:"",protocol:-1===["http","https"].indexOf(window.location.href.split(":")[0])?"https://":"//",url:getShareURL(),title:getShareTitle(),image:getShareImage(),description:getShareDescription(),networks:"Twitter,Facebook,Reddit,Mailto,Linkedin"}),updateInnerHTML("existingCardsURL","planetcrypto.app/token/"+t),$("#existingCardDiv").foundation("open"),ga("send","event","GeneralActions","ShowExistingCard",t)}}function gotoExistingCardStartPoint(){try{mymap.getZoom()<MIN_BUY_LVL?mymap.flyTo(existingCardStartPoint,18):mymap.flyTo(existingCardStartPoint,18)}catch(t){}}function setupImgMap(){}function setupMap(){function r(d){console.log("Flying to:",d),mymap.flyTo(d)}mymap=isMobile?L.map("mapid",{doubleClickZoom:!1,zoomSnap:1,boxZoom:!1,scrollWheelZoom:!0}).setView([38.3796072,-93.0596094],3,{paddingTopLeft:[300,300]}):L.map("mapid",{doubleClickZoom:!1,zoomSnap:1,boxZoom:!1,scrollWheelZoom:!0}).setView([15,0],3,{paddingTopLeft:[300,300]}),mymap.setMaxZoom(18),mymap.setMinZoom(3),layer=L.esri.basemapLayer("Streets").addTo(mymap);mymap.addControl(new L.Control.Search({url:"https://nominatim.openstreetmap.org/search?format=json&q={s}",jsonpParam:"json_callback",formatData:formatJSON,textPlaceholder:"Search...",autoType:!1,tipAutoSubmit:!0,autoCollapse:!0,autoCollapseTime:1e4,delayType:500,marker:{icon:!0}})),navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(d){0<_findTokenId.length||r(new L.LatLng(d.coords.latitude,d.coords.longitude))},function(){}),mymap.on("click",function(d){console.log("MAP CLICK",d),""==actionMode&&$.toast({heading:"Use BUY LAND Tools",text:"Use the tools at the top of the page to purchase land.<br/><br/>Click the [?] symbol for the GAME GUIDE.",icon:"info",allowToastClose:!0,position:"bottom-right",hideAfter:TOAST_HIDE_DELAY,showHideTransition:TOAST_HIDE_TRANSITION})}),mymap.on("zoomstart",function(){clearMarkers(),clearGrids(),clearDisplayedKeys(),clearSelectedRects()}),mymap.on("movestart",function(){}),mymap.on("moveend",function(d){if(clearDisplayedKeys(),!(16<d.target._zoom))queryMap(d.target._zoom);else if(hardFixed(lightGrids[d.target._zoom].options.cellSize,2)!=hardFixed(getPixelSize(PLOT_SIZE),2)){var p=getPixelSize(PLOT_SIZE);lightGrids[d.target._zoom].remove(),lightGrids[d.target._zoom].removeFrom(mymap),lightGrids[d.target._zoom]=new VirtualGrid({cellSize:p,minZoom:d.target._zoom,maxZoom:d.target._zoom,zoomTriger:d.target._zoom}),lightGrids[d.target._zoom].on("cellsupdated",function(u){clearDisplayedKeys(),queryMap(u.target._map._zoom)}),lightGrids[d.target._zoom].addTo(mymap)}}),mymap.on("gameDataReady",function(d){if(console.log("gameDataReady"),0<_findTokenId.length)try{document.getElementById("ogurl").content="https://planetcyrpto.app/token/"+_findTokenId}catch(p){}queryMap(d.target._zoom),updateUserCards()}),mymap.on("zoomend",function(d){if(!1==grid14Iinit&&14==d.target._zoom&&(0<rectsToBuyLen()&&(currentlySelectedMarker=L.marker(rectsToBuy[Object.keys(rectsToBuy)[0]],{title:"Your Currently Selectd Plots of Land to Buy",icon:blankCardIcon,riseOnHover:!0}).addTo(mymap)),grid14Iinit=!0),!(16<d.target._zoom))17>d.target._zoom;else if(!lightGrids[d.target._zoom]){var p=getPixelSize(PLOT_SIZE);lightGrids[d.target._zoom]=new VirtualGrid({cellSize:p,minZoom:d.target._zoom,maxZoom:d.target._zoom,zoomTriger:d.target._zoom}),lightGrids[d.target._zoom].on("cellsupdated",function(u){clearDisplayedKeys(),queryMap(u.target._map._zoom)}),lightGrids[d.target._zoom].addTo(mymap)}else console.log("READY");16<d.target._zoom,12<d.target._zoom,15>d.target._zoom?(allowedPlotsCircle&&allowedPlotsCircle.remove(),currentlySelectedMarker&&!0==currentlySelectedMarkerRemoved&&(currentlySelectedMarker.addTo(mymap),currentlySelectedMarkerRemoved=!1),10==d.target._zoom):(0<rectsToBuyLen()&&allowedPlotsCircle.addTo(mymap),currentlySelectedMarker&&(currentlySelectedMarker.remove(),currentlySelectedMarkerRemoved=!0))})}var currentBaseMapsHidden=!1;function toggleBasemaps(){currentBaseMapsHidden?($("#basemaps").removeClass("hide"),currentBaseMapsHidden=!1):($("#basemaps").addClass("hide"),currentBaseMapsHidden=!0)}function setBasemap(t){layer&&mymap.removeLayer(layer),layer=L.esri.basemapLayer(t),mymap.addLayer(layer),layerLabels&&mymap.removeLayer(layerLabels),"ShadedRelief"===t||"Oceans"===t||"Gray"===t||"DarkGray"===t||"Terrain"===t?(layerLabels=L.esri.basemapLayer(t+"Labels"),mymap.addLayer(layerLabels)):t.includes("Imagery")&&(layerLabels=L.esri.basemapLayer("ImageryLabels"),mymap.addLayer(layerLabels))}function changeBasemap(t){var o=t.value;setBasemap(o)}function resetButtons(){document.getElementById("newCardName").value="",$("#buySingle").removeClass("secondary").addClass("success"),$("#buyMultiple").removeClass("secondary").addClass("success"),$("#removeSingle").removeClass("secondary").addClass("warning"),$("#removeAll").removeClass("secondary").addClass("alert"),$("#buySingleMobile").removeClass("secondary").addClass("success"),$("#removeSingleMobile").removeClass("secondary").addClass("warning"),$("#removeAllMobile").removeClass("secondary").addClass("alert")}function startBuyMultiple(){mymap.getZoom()<MIN_BUY_LVL&&mymap.setZoom(MIN_BUY_LVL),actionMode="BUYMULTI",resetButtons(),$("#buyMultiple").addClass("secondary").removeClass("success"),ga("send","event","BuyTools","BuySingleOrMultiple")}function startRemoveSingle(){mymap.getZoom()<MIN_BUY_LVL&&mymap.setZoom(MIN_BUY_LVL),actionMode="REMOVESINGLE",resetButtons(),$("#removeSingle").addClass("secondary").removeClass("warning"),$("#removeSingleMobile").addClass("secondary").removeClass("warning")}function startBuySingle(){mymap.getZoom()<MIN_BUY_LVL&&mymap.setZoom(MIN_BUY_LVL),actionMode="BUYSINGLE",resetButtons(),$("#buySingle").addClass("secondary").removeClass("success"),$("#buySingleMobile").addClass("secondary").removeClass("success"),ga("send","event","BuyTools","BuySingleOrMultiple")}function startRemoveAll(){resetSelectedRects(),resetButtons()}function showNewCard(){$("#newCardDiv").removeClass("hide")}function hideNewCard(){$("#newCardDiv").removeClass("hide").addClass("hide")}function gotoStartPointLink(){try{mymap.getZoom()<MIN_BUY_LVL?mymap.flyTo(L.latLng(document.getElementById("newCardStartPoint").innerHTML.split(",")),18):mymap.flyTo(L.latLng(document.getElementById("newCardStartPoint").innerHTML.split(",")),18)}catch(t){}}function updateNewCard(){var t=rectsToBuyLen();if(0<t){updateInnerHTML("newCardStartPoint",rectsToBuy[Object.keys(rectsToBuy)[0]].lat.toFixed(4)+","+rectsToBuy[Object.keys(rectsToBuy)[0]].lng.toFixed(4)),updateInnerHTML("newCardTotalPlots",t),updateInnerHTML("newCardTotalPlotsSize",20*t+"m");var o=currentLandPrice.times(t);try{updateInnerHTML("newCardsCost",getReadOnlyWeb3Utils().utils.fromWei(o.toString(),"ether").substring(0,8))}catch(r){updateInnerHTML("newCardsCost",o.div(1e18).toString().substring(0,8))}updateInnerHTML("newCardsEmpireScore",t*currentEmpirePerPlot),updateInnerHTML("newPlanetCOINs",Math.floor(t/10)),updateInnerHTML("newCardBadge",pad(t*currentEmpirePerPlot,5)),checkforFirstPlot(t)}else{clearNewBuyCard();try{allowedPlotsCircle.remove()}catch(r){}}}function clearNewBuyCard(){$("#newCardDiv").addClass("hide"),updateInnerHTML("newCardStartPoint","--,--"),updateInnerHTML("newCardTotalPlots","0"),updateInnerHTML("newCardTotalPlotsSize","0m"),updateInnerHTML("newCardsCost","0"),hideNewCard()}function checkforFirstPlot(t){1==t&&(showNewCard(),allowedPlotsCircle&&allowedPlotsCircle.remove(),allowedPlotsCircle=L.circle(rectsToBuy[Object.keys(rectsToBuy)[0]],{color:"black",radius:MAX_BUY_RADIUS,fill:!1}),mymap.addLayer(allowedPlotsCircle))}function checkBuyPointAllowed(t,o){if(0<rectsToBuyLen()){var r=rectsToBuy[Object.keys(rectsToBuy)[0]];if(Math.abs(r.distanceTo(t))<=MAX_BUY_RADIUS)return!0;if(o){var l="<p>Each trading card can only hold plots of land that are within "+MAX_BUY_RADIUS+"m radius of the original plot.</p>";l+="<p>This helps prevent trading cards getting too split across the globe.</p>",l+="<p>Please select a plot that is within the circle shown on the map.</p>",showError(l,"plot too far from original")}return!1}return!0}function coordsToKey(t){return t.x+":"+t.y+":"+t.z}function rectsToBuyLen(){return Object.keys(rectsToBuy).length}function getPixelSize(t){var o=mymap.getCenter(),r=mymap.latLngToContainerPoint(o),l=[r.x+1,r.y],d=[r.x,r.y+1],p=mymap.containerPointToLatLng(r),u=mymap.containerPointToLatLng(l),g=mymap.containerPointToLatLng(d),m=p.distanceTo(u),m=p.distanceTo(g);return hardFixed(t/m,2)}function getPixelSize2(t,o){var r=o.getCenter(),l=o.latLngToContainerPoint(r),d=[l.x+1,l.y],p=[l.x,l.y+1],u=o.containerPointToLatLng(l),g=o.containerPointToLatLng(d),m=o.containerPointToLatLng(p),h=u.distanceTo(g),h=u.distanceTo(m);return t/h}function getUrlParameter(t){var l,d,o=decodeURIComponent(window.location.search.substring(1)),r=o.split("&");for(d=0;d<r.length;d++)if(l=r[d].split("="),l[0]===t)return void 0===l[1]||l[1]}function formatJSON(t){var r,l,o={},d=[];for(var p in t)d=t[p].display_name.split(","),r=d[0]+", "+d[1],l=L.latLng(t[p].lat,t[p].lon),o[r]=l;return o}function showError(t,o){o&&updateInnerHTML("errorHeader",o),updateInnerHTML("errorContent",t),$("#errorMessage").foundation("open")}function updateInnerHTML(t,o){document.getElementById(t).innerHTML=o}function onlyUnique(t,o,r){return r.indexOf(t)===o}function hardFixed(t,o){if("0"==t)return 0;var r=t.toString().split(".");return 0<r.length?parseFloat(r[0].toString()+"."+r[1].toString().substring(0,o)):parseFloat(r[0])}function normaliseLatLngUp(t){var o=t.toString().length,r=parseInt(t.toString().substring(o-1,1)),l=parseInt(t.toString().substring(o-2,1));return 5>=r?parseFloat(t.toString().substring(0,o-1)+"1"):(l++,parseFloat(t.toString().substring(0,o-2)+l.toString()+"1"))}function normaliseLatLngDown(t){var o=t.toString().length,r=parseInt(t.toString().substring(o-1,1)),l=parseInt(t.toString().substring(o-2,1));return 5<=r?(l++,parseFloat(t.toString().substring(0,o-1)+l.toString()+"1")):parseFloat(t.toString().substring(0,o-2)+"1")}function pad(t,o,r){return r=r||"0",t+="",t.length>=o?t:Array(o-t.length+1).join(r)+t}var playerStats=[];function updatePreviousCards(){$("#userLostCards").empty(),$("#userLostCards2").empty(),console.log("updatePreviousCards",tokens[1]),console.log("canPlay",canPlay),canPlay&&Object.keys(tokens).forEach(function(t){var r=tokens[t];processPreviousCardsToken(r,t)})}function processPreviousCardsToken(t,o){var r=!1;if(t.token_owner.toUpperCase()!=userWalletAddress.toUpperCase()){for(var l=0;l<t.buy_history.length;l++)if(t.buy_history[l].from.toUpperCase()==userWalletAddress.toUpperCase()){r=!0;break}if(r){console.log("Used to own but no longer:",t);var d;if(document.getElementById("latestCardFull_previous_"+o))try{d=document.getElementById("latestCardFull_previous_"+o).value}catch(u){}if(d);else{var p=latestCardsFull.replace(/\[\]/g,"_previous_"+o);isMobile?$("#userLostCards2").prepend(p):$("#userLostCards").prepend(p)}$("#latestCardHeader_previous_"+o).css("background-color","#"+t.token_owner.substring(t.token_owner.length-6)),updateInnerHTML("latestCardsName_previous_"+o,t.name),updateInnerHTML("latestCardsCardOwner_previous_"+o,t.token_owner.substring(0,15)+"..."),updateInnerHTML("latestCardsStartPoint_previous_"+o,hardFixed(t.plots_lat[0]/1e6,4)+","+hardFixed(t.plots_lng[0]/1e6,4)),1<t.plots_lat.length?updateInnerHTML("latestCardsTotalPlots_previous_"+o,t.plots_lat.length+" Plots"):updateInnerHTML("latestCardsTotalPlots_previous_"+o,t.plots_lat.length+" Plot"),updateInnerHTML("latestCardsTotalPlotsSize_previous_"+o,t.plots_lat.length*PLOT_SIZE+"m<sup>"),updateInnerHTML("latestCardsEmpireScore_previous_"+o,t.empire_score),updateInnerHTML("latestCardsBadge_previous_"+o,pad(t.empire_score,5)),updateInnerHTML("latestCardsCost_previous_"+o,getReadOnlyWeb3Utils().utils.fromWei(t.current_value.toString(),"ether").substring(0,8)),document.getElementById("latestCardFull_previous_"+o).value=o}}}function updateUserCards(){var o=Object.keys(tokens).length,r=o-50;0>r&&(r=0),playerStats=[],$("#latestCards").empty(),$("#latestCards2").empty(),$("#userLostCards").empty(),$("#userLostCards2").empty(),Object.keys(tokens).forEach(function(y,f){for(var C=tokens[y],v=-1,w=0;w<playerStats.length;w++)if(playerStats[w].playerAddress&&playerStats[w].playerAddress.toUpperCase()==C.token_owner.toUpperCase()){v=w;break}if(-1==v?playerStats.push({playerAddress:C.token_owner,totalEmpireScore:C.empire_score,totalLand:C.plots_lng.length}):(playerStats[v].totalEmpireScore=parseInt(playerStats[v].totalEmpireScore)+parseInt(C.empire_score),playerStats[v].totalLand=parseInt(playerStats[v].totalLand)+parseInt(C.plots_lng.length)),canPlay){if(tokens[y].token_owner.toUpperCase()==userWalletAddress.toUpperCase()){var k;if(document.getElementById("userCardFull"+y)&&(k=document.getElementById("userCardFull"+y).value),k);else{var _=userCardsFull.replace(/\[\]/g,y);isMobile?$("#userCards2").prepend(_):$("#userCards").prepend(_)}$("#userCardHeader"+y).css("background-color","#"+C.token_owner.substring(C.token_owner.length-6)),updateInnerHTML("userCardsName"+y,C.name),updateInnerHTML("userCardsCardOwner"+y,C.token_owner.substring(0,15)+"..."),updateInnerHTML("userCardsStartPoint"+y,hardFixed(C.plots_lat[0]/1e6,4)+","+hardFixed(C.plots_lng[0]/1e6,4)),1<C.plots_lat.length?updateInnerHTML("userCardsTotalPlots"+y,C.plots_lat.length+" Plots"):updateInnerHTML("userCardsTotalPlots"+y,C.plots_lat.length+" Plot"),updateInnerHTML("userCardsTotalPlotsSize"+y,C.plots_lat.length*PLOT_SIZE+"m<sup>"),updateInnerHTML("userCardsEmpireScore"+y,C.empire_score),updateInnerHTML("userCardsBadge"+y,pad(C.empire_score,5)),updateInnerHTML("userCardsCost"+y,getReadOnlyWeb3Utils().utils.fromWei(C.current_value.toString(),"ether").substring(0,8)),document.getElementById("userCardFull"+y).value=y}processPreviousCardsToken(C,y)}if(f==r){var k=0;if(document.getElementById("latestCardFull"+y))try{k=document.getElementById("latestCardFull"+y).value}catch(T){}if(0<k);else{var _=latestCardsFull.replace(/\[\]/g,y);isMobile?$("#latestCards2").prepend(_):$("#latestCards").prepend(_)}$("#latestCardHeader"+y).css("background-color","#"+C.token_owner.substring(C.token_owner.length-6)),updateInnerHTML("latestCardsName"+y,C.name),updateInnerHTML("latestCardsCardOwner"+y,C.token_owner.substring(0,15)+"..."),updateInnerHTML("latestCardsStartPoint"+y,hardFixed(C.plots_lat[0]/1e6,4)+","+hardFixed(C.plots_lng[0]/1e6,4)),1<C.plots_lat.length?updateInnerHTML("latestCardsTotalPlots"+y,C.plots_lat.length+" Plots"):updateInnerHTML("latestCardsTotalPlots"+y,C.plots_lat.length+" Plot"),updateInnerHTML("latestCardsTotalPlotsSize"+y,C.plots_lat.length*PLOT_SIZE+"m<sup>"),updateInnerHTML("latestCardsEmpireScore"+y,C.empire_score),updateInnerHTML("latestCardsBadge"+y,pad(C.empire_score,5)),updateInnerHTML("latestCardsCost"+y,getReadOnlyWeb3Utils().utils.fromWei(C.current_value.toString(),"ether").substring(0,8)),document.getElementById("latestCardFull"+y).value=y,r++}}),$("#LeaderboardTable").find("tr:gt(0)").remove(),$("#LeaderboardTable2").find("tr:gt(0)").remove();for(var l=playerStatsSortedByEmpireScore(),d=0,p=0;p<l.length;p++)d+=parseInt(l[p].totalEmpireScore);for(var p=0;p<l.length;p++){var u="<tr><td width=\"500\"><a href=\"https://etherscan.io/address/"+l[p].playerAddress+"\" target=\"_new\">"+l[p].playerAddress+"</a></td>",g="<tr><td width=\"500\"><a href=\"https://etherscan.io/address/"+l[p].playerAddress+"\" target=\"_new\">"+l[p].playerAddress.substring(0,7)+"...</a></td>",m=parseInt(l[p].totalLand)*PLOT_SIZE,h="m";if(99999<m&&(m/=1e3,h="km"),u+="<td width=\"150\">"+m+h+"<sup>2</sup></td>",g+="<td width=\"150\">"+m+h+"<sup>2</sup></td>",u+="<td width=\"150\">"+l[p].totalEmpireScore+"</td>",u+="<td width=\"150\">"+(100*(parseFloat(l[p].totalEmpireScore)/parseFloat(d))).toFixed(2)+"%</td>",g+="<td width=\"150\">"+l[p].totalEmpireScore+"</td></tr>",$("#LeaderboardTable tbody").append(u),$("#LeaderboardTable2 tbody").append(g),20<=p)break}}function playerStatsSortedByEmpireScore(){return playerStats.sort(function(t,o){return parseInt(o.totalEmpireScore)-parseInt(t.totalEmpireScore)})}function playerStatsSortedByLand(){return playerStats.sort(function(t,o){return parseInt(o.totalLand)-parseInt(t.totalLand)})}function showGuide(){$("#welcomeDiv").foundation("close"),$("#guideDiv").foundation("open"),ga("send","event","GeneralActions","ShowGuide")}function showExistingUserCard(t){showExistingCard(t.value,!0)}function showLatestUserCard(t){$("#offCanvasRightLatestCards").foundation("close"),$("#offCanvasRightYourCards").foundation("close"),showExistingCard(t.value,!0)}var userCardsFull="<div class=\"userCardsItemFull\" id=\"userCardFull[]\" onclick=\"showExistingUserCard(this);\">";userCardsFull+="                      <div class=\"large badge alert existingCardBadge\" id=\"userCardsBadge[]\">00000</div>",userCardsFull+="",userCardsFull+="                      <div class=\"card userCardItemInnerCardDiv\"  >",userCardsFull+="                        <form style=\"padding: 4px;\">",userCardsFull+="                          <div class=\"userCardsMainContent\"><div style=\"background-color: rgba(255,255,255,0.9); width: 100%; height: 100%;\">",userCardsFull+="                                ",userCardsFull+="                                <div id=\"userCardHeader[]\" class=\"card-divider text-center userCardsHeader\" >",userCardsFull+="                                  <div class=\"innerHeader\">",userCardsFull+="                                    <strong style=\"font-size: 0.4em;\">TITLE DEED</strong>",userCardsFull+="                                    <h4 style=\"width: 100%; background-color: #efefef; color: black; font-size:0.9em; overflow-y: scroll;\" id=\"userCardsName[]\"></h4>",userCardsFull+="                                    ",userCardsFull+="                                  </div>",userCardsFull+="                                </div>",userCardsFull+="",userCardsFull+="                                <div class=\"card-section\" style=\"margin: 5px; padding:10px; \">",userCardsFull+="                                  <p class=\"smallTxt\" style=\"font-weight: bold;\">",userCardsFull+="                                    <img class=\"icon-house\"/> <strong><span id=\"userCardsCardOwner[]\">0x0</span></strong><br/>",userCardsFull+="                                    <img class=\"icon-compass\"/> <strong><span id=\"userCardsStartPoint[]\">0.0000, 0.0000</span></strong><br/>",userCardsFull+="                                    <img class=\"icon-size\"/> <strong><span id=\"userCardsTotalPlots[]\">0</span></strong><br/>",userCardsFull+="                                    <img class=\"icon-ruler\"/> <strong><span id=\"userCardsTotalPlotsSize[]\">0m</span><sup>2</sup></strong><br/>",userCardsFull+="                                    <img class=\"icon-trophy\"/> <strong>+<span id=\"userCardsEmpireScore[]\">0</span></strong><br/>",userCardsFull+="                                    <img class=\"icon-eth\"/> <strong><span id=\"userCardsCost[]\">0.000</span> ETH</strong></p>",userCardsFull+="",userCardsFull+="                                </div>",userCardsFull+="",userCardsFull+="                              </div></div>",userCardsFull+="",userCardsFull+="                        </form>",userCardsFull+="                      </div>",userCardsFull+="                    </div>";var latestCardsFull="<div class=\"userCardsItemFull\" id=\"latestCardFull[]\" onclick=\"showLatestUserCard(this);\">";latestCardsFull+="                      <div class=\"large badge alert existingCardBadge\" id=\"latestCardsBadge[]\">00000</div>",latestCardsFull+="",latestCardsFull+="                      <div class=\"card userCardItemInnerCardDiv\"  >",latestCardsFull+="                        <form style=\"padding: 4px;\">",latestCardsFull+="                          <div class=\"userCardsMainContent\"><div style=\"background-color: rgba(255,255,255,0.9); width: 100%; height: 100%;\">",latestCardsFull+="                                ",latestCardsFull+="                                <div id=\"latestCardHeader[]\" class=\"card-divider text-center userCardsHeader\" >",latestCardsFull+="                                  <div class=\"innerHeader\">",latestCardsFull+="                                    <strong style=\"font-size: 0.4em;\">TITLE DEED</strong>",latestCardsFull+="                                    <h4 style=\"width: 100%; background-color: #efefef; color: black; font-size:0.9em; overflow-y: scroll;\" id=\"latestCardsName[]\"></h4>",latestCardsFull+="                                    ",latestCardsFull+="                                  </div>",latestCardsFull+="                                </div>",latestCardsFull+="",latestCardsFull+="                                <div class=\"card-section\" style=\"margin: 5px; padding:10px; \">",latestCardsFull+="                                  <p class=\"smallTxt\" style=\"font-weight: bold;\">",latestCardsFull+="                                    <img class=\"icon-house\"/> <strong><span id=\"latestCardsCardOwner[]\">0x0</span></strong><br/>",latestCardsFull+="                                    <img class=\"icon-compass\"/> <strong><span id=\"latestCardsStartPoint[]\">0.0000, 0.0000</span></strong><br/>",latestCardsFull+="                                    <img class=\"icon-size\"/> <strong><span id=\"latestCardsTotalPlots[]\">0</span></strong><br/>",latestCardsFull+="                                    <img class=\"icon-ruler\"/> <strong><span id=\"latestCardsTotalPlotsSize[]\">0m</span><sup>2</sup></strong><br/>",latestCardsFull+="                                    <img class=\"icon-trophy\"/> <strong>+<span id=\"latestCardsEmpireScore[]\">0</span></strong><br/>",latestCardsFull+="                                    <img class=\"icon-eth\"/> <strong><span id=\"latestCardsCost[]\">0.000</span> ETH</strong></p>",latestCardsFull+="",latestCardsFull+="                                </div>",latestCardsFull+="",latestCardsFull+="                              </div></div>",latestCardsFull+="",latestCardsFull+="                        </form>",latestCardsFull+="                      </div>",latestCardsFull+="                    </div>";function byteCount(t){return encodeURI(t).split(/%..|./).length-1}function showProcessing(){$("#processingDiv").removeClass("hide")}function hideProcessing(){$("#processingDiv").addClass("hide")}function googleTranslateElementInit(){new google.translate.TranslateElement({pageLanguage:"en",includedLanguages:"ar,en,es,fr,jv,ko,ja,ru,zh-CN,de,id,it",layout:google.translate.TranslateElement.InlineLayout.SIMPLE,autoDisplay:!1},"google_translate_element"),$("#google_translate_element").on("click",function(){$("iframe").contents().find(".goog-te-menu2-item div, .goog-te-menu2-item:link div, .goog-te-menu2-item:visited div, .goog-te-menu2-item:active div, .goog-te-menu2 *").css({color:"#544F4B","font-family":"Roboto",width:"100%"}),$("iframe").contents().find(".goog-te-menu2-item-selected").css("display","none"),$("iframe").contents().find(".goog-te-menu2").css("padding","0px"),$("iframe").contents().find(".goog-te-menu2-item div").css("padding","20px"),$("iframe").contents().find(".goog-te-menu2-item").css("width","100%"),$("iframe").contents().find("td").css("width","100%"),$("iframe").contents().find(".goog-te-menu2-item div").hover(function(){$(this).css("background-color","#4385F5").find("span.text").css("color","white")},function(){$(this).css("background-color","white").find("span.text").css("color","#544F4B")}),$("iframe").contents().find(".goog-te-menu2").css("border","none"),$(".goog-te-menu-frame").css("box-shadow","0 16px 24px 2px rgba(0, 0, 0, 0.14), 0 6px 30px 5px rgba(0, 0, 0, 0.12), 0 8px 10px -5px rgba(0, 0, 0, 0.3)"),$(".goog-te-menu-frame").css({height:"100%",width:"100%",top:"0px"}),$("iframe").contents().find(".goog-te-menu2").css({height:"100%",width:"100%"})})}function processJumpToLocationEvent(t){var o=$("option:selected",t),r=t.value;"token"==r.substring(0,5)?_findTokenId=r.split(":")[1]:mymap.flyTo(L.latLng(r.split(",")[0],r.split(",")[1]),10)}function getShareURL(){return"https://planetcrypto.app/token/"+existingCardTokenId}function getShareDescription(){return share_description}function getShareTitle(){return share_title}function getShareImage(){return"https://api.planetcrypto.app/img/"+existingCardTokenId}function destroyConfirm(){existingCardOwned?$("#destroyConfirm").foundation("open"):$("#destroyConfirmUnowned").foundation("open")}function flyTo(t,o){mymap.flyTo(L.latLng(t,o),12)}